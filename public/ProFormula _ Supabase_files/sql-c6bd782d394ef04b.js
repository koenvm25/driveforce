(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2031],{84151:function(e,t,n){"use strict";var r=n(44285),i=(n(27378),n(88983)),a=n(79894),s=n(24246);t.Z=function(e){var t=e.title,n=e.description,o=e.children,c=e.footer,l=e.url,u=void 0===l?"":l,d=e.linkHref,h=void 0===d?"":d,f=e.imgUrl,p=e.imgAlt,v=e.onClick,m=e.icon,x=e.containerHeightClassName,b=function(e){var t=e.children;return(0,s.jsx)(a.default,{href:h,children:(0,s.jsx)("a",{children:t})})},g=function(e){var t=e.children;return(0,s.jsx)("a",{href:u,children:t})},y=function(e){var t=e.children;return(0,s.jsx)("div",{children:t})},j=function(e){var t=e.children;return(0,s.jsx)("button",{onClick:v,children:t})},k=u||h||v,N=["group relative text-left","bg-panel-header-light dark:bg-panel-header-dark","border border-panel-border-light dark:border-panel-border-dark","rounded-md py-4 px-6 flex flex-row","transition ease-in-out duration-150",void 0===x?"h-32":x];k&&(N=[].concat((0,r.Z)(N),["cursor-pointer","hover:bg-panel-border-light dark:hover:bg-panel-border-dark","hover:border-panel-border-hover-light","dark:hover:border-panel-border-hover-dark hover:border-gray-300"]));var C=function(e){var t=e.children;return(0,s.jsx)("div",{className:"mr-4 flex flex-col",children:t})},w=(0,s.jsxs)("div",{className:N.join(" "),children:[f&&(0,s.jsx)(C,{children:(0,s.jsx)("img",{className:" transition-all group-hover:scale-110 ",src:"".concat(f),alt:"".concat(p),width:"26"})}),m&&(0,s.jsx)(C,{children:m}),(0,s.jsxs)("div",{className:"flex h-full w-full flex-col space-y-2",children:[(0,s.jsx)("h5",{className:"text-scale-1200",children:t}),(o||n)&&(0,s.jsxs)("div",{className:"flex w-full flex-1 flex-col",children:[(0,s.jsx)("p",{className:"text-sm text-scale-1100",children:n}),(0,s.jsx)("div",{className:"w-full",children:o&&o})]}),c&&(0,s.jsx)("div",{className:"w-full",children:c})]}),k&&(0,s.jsx)("div",{className:" absolute right-4 top-4 text-scale-900 transition-all duration-200 group-hover:right-3 group-hover:text-scale-1200 ",children:(0,s.jsx)(i.VG8,{})})]});return v?(0,s.jsx)(j,{children:w}):h?(0,s.jsx)(b,{children:w}):u?(0,s.jsx)(g,{children:w}):(0,s.jsx)(y,{children:w})}},76446:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Ne}});var r=n(55732),i=n(34707),a=n.n(i),s=n(27378),o=n(25229),c=n(90085),l=n(41224),u=n(11246),d=n(98784),h=n(68043),f=n(30398),p=n(42791),v=n(72036),m=n(84151),x=n(24246),b=(0,o.Pi)((function(){var e,t,n=(0,p.oR)().ui,r=(0,d.partition)(v.o,{type:"template"}),i=(0,u.Z)(r,2),a=i[0],s=i[1],o=(0,p.FH)(h.KA.CREATE,"user_content",{resource:{type:"sql",owner_id:null===(e=n.profile)||void 0===e?void 0:e.id},subject:{id:null===(t=n.profile)||void 0===t?void 0:t.id}}),c=(0,p.gM)(o);return(0,x.jsxs)("div",{className:"block h-full space-y-8 overflow-y-auto p-6",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("h1",{className:"text-scale-1200 mb-3 text-xl",children:"Scripts"}),(0,x.jsx)("p",{className:"text-scale-1100 text-sm",children:"Quick scripts to run on your database."}),(0,x.jsxs)("p",{className:"text-scale-1100 text-sm",children:["Click on any script to fill the query box, modify the script, then click",(0,x.jsx)("span",{className:"text-code",children:"Run"}),"."]})]}),(0,x.jsx)("div",{className:"grid gap-4 sm:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4",children:a.map((function(e){return(0,x.jsx)(y,{title:e.title,description:e.description,sql:e.sql,onClick:function(t,r){c({sql:t,name:r}),f.Z.sendEvent({category:"scripts",action:"script_clicked",label:e.title},n.googleAnalyticsProps)}},e.title)}))})]}),(0,x.jsxs)("div",{className:"mb-8",children:[(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("h1",{className:"text-scale-1200 mb-3 text-xl",children:"Quick start"}),(0,x.jsx)("p",{className:"text-scale-1100 text-sm",children:"While we're in beta, we want to offer a quick way to explore Supabase. While we build importers, check out these simple starters."}),(0,x.jsxs)("p",{className:"text-scale-1100 text-sm",children:["Click on any script to fill the query box, modify the script, then click",(0,x.jsx)("span",{className:"text-code",children:"Run"}),"."]})]}),(0,x.jsx)("div",{className:"grid gap-4 sm:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4",children:s.map((function(e){return(0,x.jsx)(y,{title:e.title,description:e.description,sql:e.sql,onClick:function(t,r){c({sql:t,name:r}),f.Z.sendEvent({category:"quickstart",action:"quickstart_clicked",label:e.title},n.googleAnalyticsProps)}},e.title)}))})]})]})})),g=b,y=function(e){var t=e.title,n=e.description,r=e.sql,i=e.onClick,a=(0,s.useState)(!1),o=(a[0],a[1]);function c(){o(!0),i(r,t)}return(0,x.jsx)(m.Z,{onClick:function(){return c()},title:t,footer:(0,x.jsx)("span",{className:"text-scale-1100 text-sm",children:n})})},j=n(90849),k=n(27314),N=n(98637),C=n(60042),w=n.n(C),T=n(15724),E=n(88983),S=n(98574),_=n(53041),A=n(24532),P=n(20796),I=n(79588),q=(0,o.Pi)((function(e){var t=e.updateSqlSnippet,n=(0,p.oR)().content,r=(0,l.JU)(),i=(0,p.D9)(n.savingState),a=(0,s.useState)(!1),o=a[0],c=a[1];(0,s.useEffect)((function(){var e=!1;return"CREATING"!==i&&"UPDATING"!==i||"IDLE"!==n.savingState||(c(!0),setTimeout((function(){e||c(!1)}),3e3)),function(){return e=!0}}),[n.savingState]);return(0,x.jsxs)("div",{className:"mx-2 flex items-center gap-2",children:[("CREATING_FAILED"===n.savingState||"UPDATING_FAILED"===n.savingState)&&(0,x.jsx)(E.zxk,{type:"text",size:"tiny",shadow:!1,icon:(0,x.jsx)(E.SPl,{className:"text-gray-1100",size:"tiny",strokeWidth:2}),onClick:function(){var e=n.list((function(e){return e.id===r.selectedTabId})),i=(0,u.Z)(e,1)[0];"CREATING_FAILED"===n.savingState&&i&&n.save((0,I.ZN)(i)),"UPDATING_FAILED"===n.savingState&&i&&t(r.activeTab.query)},children:"Retry"}),("CREATING"===n.savingState||"UPDATING"===n.savingState)&&(0,x.jsxs)(A.fC,{delayDuration:0,children:[(0,x.jsx)(A.xz,{children:(0,x.jsx)(E.pAw,{className:"animate-spin",size:14,strokeWidth:2})}),(0,x.jsxs)(A.VY,{side:"bottom",children:[(0,x.jsx)(A.Eh,{className:"radix-tooltip-arrow"}),(0,x.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,x.jsx)("span",{className:"text-xs text-scale-1200",children:"Saving changes..."})})]})]}),("CREATING_FAILED"===n.savingState||"UPDATING_FAILED"===n.savingState)&&(0,x.jsx)(E.Ldj,{className:"text-red-900",size:14,strokeWidth:2}),o&&(0,x.jsxs)(A.fC,{delayDuration:0,children:[(0,x.jsx)(A.xz,{children:(0,x.jsx)(E.NOm,{className:"text-brand-900",size:14,strokeWidth:3})}),(0,x.jsxs)(A.VY,{side:"bottom",children:[(0,x.jsx)(A.Eh,{className:"radix-tooltip-arrow"}),(0,x.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 "].join(" "),children:(0,x.jsx)("span",{className:"text-xs text-scale-1200",children:"All changes saved"})})]})]}),(0,x.jsxs)("span",{className:"text-sm text-scale-1000",children:["CREATING_FAILED"===n.savingState&&"Failed to create","UPDATING_FAILED"===n.savingState&&"Failed to save"]})]})}));function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,j.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=(0,o.Pi)((function(){var e=(0,p.oR)(),t=e.ui,n=e.content,i=t.profile,o=(0,l.JU)(),c=(0,s.useState)(!1),u=c[0],d=c[1],h=o.activeTab.id,v={schema_version:"1.0",content_id:h,sql:o.activeTab.query};function m(){return(m=(0,r.Z)(a().mark((function e(){var r,s,c,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,d(!0),e.next=4,n.updateSql(h,{content:R(R({},v),{},{favorite:!0})});case 4:r=o.activeTab||{},s=r.query,c=r.name,l=r.desc,o.addToFavorite(h,s,c,l),f.Z.sendEvent({category:"sql_editor",action:"sql_favourited",label:c},t.googleAnalyticsProps),o.loadTabs(o.tabsFromContentStore(n,null===i||void 0===i?void 0:i.id),!1),o.selectTab(h),d(!1),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),t.setNotification({error:e.t0,category:"error",message:"Failed to add to favourites: ".concat(e.t0.message)}),d(!1);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function b(){return b=(0,r.Z)(a().mark((function e(){var r,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.activeTab.id,e.prev=1,d(!0),e.next=5,n.updateSql(r,{content:R(R({},v),{},{favorite:!1})});case 5:s=o.activeTab||{},c=s.name,o.unFavorite(r),f.Z.sendEvent({category:"sql_editor",action:"sql_unfavourited",label:c},t.googleAnalyticsProps),o.loadTabs(o.tabsFromContentStore(n,null===i||void 0===i?void 0:i.id),!1),o.selectTab(r),d(!1),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),t.setNotification({error:e.t0,category:"error",message:"Failed to remove from favourites: ".concat(e.t0.message)}),d(!1);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),b.apply(this,arguments)}var g=o.activeTab.favorite;return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(A.fC,{delayDuration:0,children:[(0,x.jsxs)(A.VY,{side:"bottom",children:[(0,x.jsx)(A.Eh,{className:"radix-tooltip-arrow"}),(0,x.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,x.jsxs)("span",{className:"text-xs text-scale-1200",children:[g?"Remove":"Add"," this query ",g?"from":"to"," your Favourites"]})})]}),(0,x.jsx)(A.xz,{type:"button",children:(0,x.jsx)(E.zxk,{type:"text",size:"tiny",shadow:!1,onClick:g?function(){return b.apply(this,arguments)}:function(){return m.apply(this,arguments)},loading:u,icon:(0,x.jsx)(E.AUh,{size:"tiny",fill:g?"#48bb78":"gray"})})})]})})})),z=(0,o.Pi)((function(){var e=(0,l.JU)();return(0,x.jsxs)(x.Fragment,{children:[0!=e.activeTab.utilityTabHeight&&(0,x.jsx)(E.zxk,{type:"text",size:"tiny",shadow:!1,onClick:function(){e.activeTab.collapseUtilityTab()},icon:(0,x.jsx)(E.C26,{className:"text-gray-1100",size:"tiny",strokeWidth:2}),tooltip:{title:"Maximize editor",position:"top"}}),0==e.activeTab.utilityTabHeight&&(0,x.jsx)(E.zxk,{type:"text",size:"tiny",shadow:!1,onClick:function(){e.activeTab.restorePanelSize()},icon:(0,x.jsx)(E.y_Q,{className:"text-gray-1100",size:"tiny",strokeWidth:2}),tooltip:{title:"Restore panel size",position:"top"}})]})})),D=(0,o.Pi)((function(e){var t,n,i=e.updateSqlSnippet,s=(0,p.oR)().ui,o=(0,l.JU)(),c=(0,p.FH)(h.KA.CREATE,"user_content",{resource:{type:"sql",owner_id:null===(t=s.profile)||void 0===t?void 0:t.id},subject:{id:null===(n=s.profile)||void 0===n?void 0:n.id}});function u(){return d.apply(this,arguments)}function d(){return(d=(0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.isExecuting){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,o.startExecuting();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,p.aL)({"Command+Enter":function(e){e.preventDefault(),u()}},["INPUT"]),(0,x.jsxs)(x.Fragment,{children:[!c&&(0,x.jsxs)(A.fC,{delayDuration:0,children:[(0,x.jsx)(A.xz,{children:(0,x.jsx)(E.Ldj,{size:14,strokeWidth:2})}),(0,x.jsxs)(A.VY,{side:"bottom",children:[(0,x.jsx)(A.Eh,{className:"radix-tooltip-arrow"}),(0,x.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","w-48 border border-scale-200"].join(" "),children:(0,x.jsx)("span",{className:"text-xs text-scale-1200",children:"Queries are not saved as you do not have sufficient permissions"})})]})]}),(0,x.jsx)(q,{updateSqlSnippet:i}),P.Qy&&c&&(0,x.jsx)(L,{}),(0,x.jsx)(z,{}),(0,x.jsx)(E.zxk,{onClick:u,disabled:o.isExecuting,loading:o.isExecuting,type:"text",size:"tiny",shadow:!1,className:"mx-2",children:"RUN"})]})}));function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,j.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=(0,o.Pi)((function(){var e,t,n=(0,l.JU)(),i=(0,p.oR)(),o=i.ui,c=i.content,u=(0,p.dz)().height,d=(0,p.FH)(h.KA.CREATE,"user_content",{resource:{type:"sql",owner_id:null===(e=o.profile)||void 0===e?void 0:e.id},subject:{id:null===(t=o.profile)||void 0===t?void 0:t.id}});function f(e){return v.apply(this,arguments)}function v(){return(v=(0,r.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}return e.abrupt("return");case 2:if(!n.activeTab){e.next=7;break}return e.next=5,c.updateSql(n.activeTab.id,{content:{schema_version:_.h,content_id:n.activeTab.id,sql:t,favorite:n.activeTab.favorite}});case 5:e.next=8;break;case 7:console.warn("No active tab found while updating SQL snippet");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,s.useEffect)((function(){var e=parseFloat(u-44)*n.activeTab.splitSizes[1]/100;e-50<44?n.activeTab.resizeUtilityTab(0):n.activeTab.resizeUtilityTab(e-44-3)}),[u,n.activeTab.splitSizes]),(0,x.jsx)("div",{className:"flex h-full flex-col",children:(0,x.jsxs)(k.Z,{style:{height:"100%"},direction:"vertical",gutterSize:2,sizes:n.activeTab.splitSizes||[],minSize:44,snapOffset:50,expandToMin:!0,collapsed:0==n.activeTab.utilityTabHeight?1:void 0,onDragEnd:function(e){n.activeTab.setSplitSizes(e)},children:[(0,x.jsx)(M,{error:n.activeTab.sqlQueryError,updateSqlSnippet:f,setUpdatingRequired:c.setUpdatingRequired.bind(c)}),(0,x.jsx)("div",{children:(0,x.jsx)(K,{updateSqlSnippet:f})})]})})})),Q=U,M=function(e){var t=e.error,n=e.updateSqlSnippet,i=e.setUpdatingRequired,o=(0,l.JU)(),u=(0,s.useRef)(null),h=(0,s.useRef)(null);function f(){return f=(0,r.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.current=t,h.current=n,t.addAction({id:"supabase",label:"Run Query",keybindings:[n.KeyMod.CtrlCmd+n.KeyCode.Enter],contextMenuGroupId:"operation",contextMenuOrder:0,run:function(){var e=(0,r.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.isExecuting){e.next=2;break}return e.abrupt("return");case 2:return n=(null===u||void 0===u?void 0:u.current).getModel().getValueInRange(null===u||void 0===u||null===(t=u.current)||void 0===t?void 0:t.getSelection()),e.next=5,o.startExecuting(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),t.changeViewZones((function(e){e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})),e.next=6,(0,S.Vs)(500);case 6:null===t||void 0===t||t.focus();case 7:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}(0,s.useEffect)((function(){if(u.current&&h.current)if(t){if(null!==t&&void 0!==t&&t.cursorPosition){var e=u.current.getModel(),n=e.getPositionAt(t.cursorPosition);h.current.editor.setModelMarkers(e,"owner",[{startLineNumber:n.lineNumber,endLineNumber:1,startColumn:n.column,endColumn:0,message:t.message||"syntax error",severity:h.current.MarkerSeverity.Error}])}}else{var r=u.current.getModel();h.current.editor.setModelMarkers(r,"owner",[])}}),[t]),(0,s.useEffect)((function(){var e;u.current&&(null===(e=u.current)||void 0===e||e.changeViewZones((function(e){e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})))}),[o.activeTab.id]);var p=(0,d.debounce)((function(e){return n(e)}),1500);function v(){return(v=(0,r.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.activeTab.setQuery(t),null===i||void 0===i||i(),p(t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,x.jsx)("div",{className:"flex-grow overflow-y-auto border-b dark:border-dark",children:(0,x.jsx)(c.ZP,{className:"monaco-editor",theme:"supabase",onMount:function(e,t){return f.apply(this,arguments)},onChange:function(e){return v.apply(this,arguments)},defaultLanguage:"pgsql",defaultValue:o.activeTab.query,path:o.activeTab.id,options:{tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0}})})},K=(0,o.Pi)((function(e){var t=e.updateSqlSnippet,n=(0,l.JU)();return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"flex justify-between overflow-visible px-6 py-2",children:[(0,x.jsx)(V,{}),(0,x.jsx)("div",{className:"inline-flex items-center justify-end",children:(0,x.jsx)(D,{updateSqlSnippet:t})})]}),(0,x.jsx)("div",{className:"p-0 pt-0 pb-0",children:n.activeTab.activeUtilityTab==l.Jo.RESULTS&&(0,x.jsx)(G,{})})]})})),V=(0,o.Pi)((function(){var e,t=(0,p.oR)().ui,n=(0,l.JU)(),r=(0,s.useRef)(null);return(0,x.jsxs)(E.Ltx,{side:"bottom",align:"start",overlay:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(E.Ltx.Item,{onClick:function(){var e;null===(e=r.current)||void 0===e||e.link.click(),f.Z.sendEvent({category:"sql_editor",action:"sql_download_csv",label:""},t.googleAnalyticsProps)},children:"Download CSV"}),(0,x.jsx)(E.Ltx.Item,{onClick:function(){navigator&&(0,S.vQ)(n.activeTab.markdownData,(function(){t.setNotification({category:"success",message:"Copied results to clipboard"}),f.Z.sendEvent({category:"sql_editor",action:"sql_copy_as_markdown",label:""},t.googleAnalyticsProps)}))},children:"Copy as markdown"})]}),children:[(0,x.jsx)(E.zxk,{as:"span",type:"text",iconRight:(0,x.jsx)(E.C26,{}),children:"Results"}),(0,x.jsx)(T.CSVLink,{ref:r,className:"hidden",data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){var t=Z({},e);return Object.keys(e).forEach((function(n){"object"===typeof e[n]&&(t[n]=JSON.stringify(e[n]))})),t}))}((null===(e=n.activeTab)||void 0===e?void 0:e.csvData)||""),filename:"supabase_".concat(n.projectRef,"_").concat(n.activeTab.name)})]})})),G=(0,o.Pi)((function(){var e=(0,l.JU)();return 0==e.activeTab.utilityTabHeight?null:e.activeTab.isExecuting?(0,x.jsx)("div",{className:"bg-table-header-light dark:bg-table-header-dark",children:(0,x.jsx)("p",{className:"m-0 border-0 px-6 py-4 font-mono text-sm",children:"Running..."})}):e.activeTab.errorResult?(0,x.jsx)("div",{className:"bg-table-header-light dark:bg-table-header-dark",children:(0,x.jsx)("p",{className:"m-0 border-0 px-6 py-4 font-mono",children:e.activeTab.errorResult})}):e.activeTab.hasNoResult?(0,x.jsx)("div",{className:"bg-table-header-light dark:bg-table-header-dark",children:(0,x.jsxs)("p",{className:"m-0 border-0 px-6 py-4 text-sm text-scale-1000",children:["Click ",(0,x.jsx)("code",{children:"RUN"})," or hit"," ",(0,x.jsxs)("code",{children:[window.navigator.platform.match(/^Mac/)?"\u2318":"Ctrl"," + Enter"]})," to execute your query."]})}):(0,x.jsx)("div",{style:{height:e.activeTab.utilityTabHeight},children:(0,x.jsx)(J,{results:e.activeTab.results})})})),J=function(e){var t=e.results,n=(0,s.useState)(void 0),r=n[0],i=n[1],a=(0,s.useState)(void 0),o=a[0],c=a[1];if((0,p.aL)({"Command+c":function(e){e.stopPropagation(),d()},"Control+c":function(e){e.stopPropagation(),d()}},["INPUT","TEXTAREA"]),(0,s.useEffect)((function(){var e=0;return o&&(e=setTimeout((function(){c(void 0)}),1e3)),function(){e&&clearTimeout(e)}}),[o]),null!==t&&void 0!==t&&t.error)return(0,x.jsx)("div",{className:"bg-table-header-light dark:bg-table-header-dark",children:(0,x.jsxs)("p",{className:"m-0 border-0 px-6 py-4 font-mono text-scale-1000",children:["ERROR: ",t.error]})});if(!t.length)return(0,x.jsx)("div",{className:"bg-table-header-light dark:bg-table-header-dark",children:(0,x.jsx)("p",{className:"m-0 border-0 px-6 py-4 font-mono text-sm",children:"Success. No rows returned"})});var l=function(e,t,n){var r=o==="".concat(e,",").concat(n);return(0,x.jsxs)("div",{className:"group sb-grid-select-cell__formatter overflow-hidden",children:[(0,x.jsx)("span",{className:"font-mono text-xs truncate",children:JSON.stringify(t[e])}),void 0!=t[e]&&(0,x.jsx)(E.zxk,{type:"outline",icon:r?(0,x.jsx)(E.NOm,{size:"tiny"}):(0,x.jsx)(E.Rx8,{size:"tiny"}),onClick:function(){return function(e,t,n){(0,S.vQ)(H(t[e]),(function(){c("".concat(e,",").concat(n))}))}(e,t,n)},className:w()("mx-1 group-hover:block group-hover:opacity-50 hover:opacity-100",!r&&"hidden"),title:"Copy"})]})},u=Object.keys(t[0]).map((function(e){return{key:e,name:e,formatter:function(n){var r=n.row;return l(e,r,t.indexOf(r))},headerRenderer:function(){return t=e,(0,x.jsx)("div",{className:"flex h-full items-center justify-center font-mono",children:t});var t},resizable:!0,width:120}}));function d(){if(u&&r){var e,n,i=r.idx,a=r.rowIdx,s=u[i];if(!s)return;var o=s.key,c=H(null!==(e=null===(n=t[a])||void 0===n?void 0:n[o])&&void 0!==e?e:"");(0,S.vQ)(c)}}return(0,x.jsx)(N.ZP,{columns:u,rows:t,style:{height:"100%"},onSelectedCellChange:function(e){i(e)}})};function H(e){return null===e?"":"object"==typeof e||Array.isArray(e)?JSON.stringify(e):e}var W=n(43350),Y=n(80040),$="\n".charCodeAt(0),X="\t".charCodeAt(0),B=" ".charCodeAt(0),ee="[".charCodeAt(0),te="]".charCodeAt(0),ne="{".charCodeAt(0),re="}".charCodeAt(0),ie="(".charCodeAt(0),ae=")".charCodeAt(0),se=",".charCodeAt(0),oe=".".charCodeAt(0),ce="'".charCodeAt(0),le='"'.charCodeAt(0),ue="_".charCodeAt(0),de="a".charCodeAt(0),he="z".charCodeAt(0),fe="A".charCodeAt(0),pe="Z".charCodeAt(0),ve="0".charCodeAt(0),me="9".charCodeAt(0),xe=function(){function e(t,n,r){(0,W.Z)(this,e),(0,j.Z)(this,"_line",void 0),(0,j.Z)(this,"_text",void 0),(0,j.Z)(this,"_lines",void 0),(0,j.Z)(this,"model",void 0),(0,j.Z)(this,"offset",void 0),(0,j.Z)(this,"lineNumber",void 0),this.model=t,this.offset=n,this.lineNumber=r,this._text=t.getValue(),this._lines=this._text.split(/\r?\n/g),this._line=this._lines[r]}return(0,Y.Z)(e,[{key:"hasNext",value:function(){return this.lineNumber>=0||this.offset>=0}},{key:"isFowardDQuote",value:function(){return!!this.hasForward()&&this.peekForward()===le}},{key:"isNextDQuote",value:function(){return!!this.hasNext()&&this.peekNext()===le}},{key:"isNextPeriod",value:function(){return!!this.hasNext()&&this.peekNext()===oe}},{key:"peekNext",value:function(){return this.offset<0?this.lineNumber>0?$:0:this._line.charCodeAt(this.offset)}},{key:"hasForward",value:function(){return this.lineNumber<this._lines.length||this.offset<this._line.length}},{key:"peekForward",value:function(){return this.offset===this._line.length?this.lineNumber===this._lines.length?0:$:this._line.charCodeAt(this.offset+1)}},{key:"next",value:function(){if(this.offset<0)return this.lineNumber>0?(this.lineNumber--,this._line=this._lines[this.lineNumber],this.offset=this._line.length-1,$):(this.lineNumber=-1,0);var e=this._line.charCodeAt(this.offset);return this.offset--,e}},{key:"readArguments",value:function(){for(var e=0,t=0,n=0,r=0;this.hasNext();){var i=this.next();switch(i){case ie:if(--e<0)return r;break;case ae:e++;break;case ne:n--;break;case re:n++;break;case ee:t--;break;case te:t++;break;case le:case ce:for(;this.hasNext()&&i!==this.next(););break;case se:e||t||n||r++}}return-1}},{key:"readIdent",value:function(){for(var e=!1,t=!1,n="";this.hasNext();){var r=this.peekNext();if(e&&!t&&!this._isIdentPart(r))break;if(r=this.next(),e||!t||r!==le){if(e||r!==B&&r!==X&&r!=$)if(e||r!==le&&!this._isIdentPart(r)){if(e)if(t){if(0===r)break;if(n=String.fromCharCode(r)+n,r===le)break}else n=String.fromCharCode(r)+n}else e=!0,t=r===le,n=String.fromCharCode(r)+n}else e=!0}return n}},{key:"readIdents",value:function(e){for(var t=[];e>0;){e--;var n=this.readIdent();if(!n)break;if(t.push(n),!this.isNextPeriod())break}return t.reverse()}},{key:"_isIdentPart",value:function(e){return e===ue||e>=de&&e<=he||e>=fe&&e<=pe||e>=ve&&e<=me}}]),e}();function be(e,t){return{triggerCharacters:[" ",".",'"'],provideCompletionItems:function(n,r,i){try{var a=new xe(n,r.column-2,r.lineNumber-1);return'"'===i.triggerCharacter?function(e,t,n){var r=[];if(!n.isFowardDQuote())return{suggestions:r};if(n.next(),n.isNextPeriod()){var i=n.readIdent(),a=!1;i.match(/^\".*?\"$/)&&(a=!0,i=ge(i));var s=t.tableCache.find((function(e){return a&&e.tablename===i||!a&&e.tablename.toLocaleLowerCase()==i.toLocaleLowerCase()}));if(!s)return{suggestions:r};s.columns.forEach((function(t){r.push({label:t.attname,kind:e.languages.CompletionItemKind.Property,detail:t.data_type,insertText:t.attname})}))}else t.tableCache.forEach((function(t){r.push({label:t.tablename,kind:e.languages.CompletionItemKind.Class,insertText:t.tablename})}));return{suggestions:r}}(e,t,a):"."===i.triggerCharacter?function(e,t,n){var r=[],i=function(e,t){return e.readIdents(t).map((function(e){var t=!1;return e.match(/^\".*?\"$/)&&(t=!0,e=ge(e)),{isQuoted:t,name:e}}))}(n,3),a=0,s=t.schemaCache.find((function(e){var t,n,r=i&&i.length>a?i[a]:{};return r.isQuoted&&e.name===r.name||!r.isQuoted&&(null===(t=e.name)||void 0===t?void 0:t.toLocaleLowerCase())==(null===(n=r.name)||void 0===n?void 0:n.toLocaleLowerCase())}));s?a++:s=t.schemaCache.find((function(e){return"public"==e.name}));if(i.length==a)return t.tableCache.forEach((function(t){t.schemaname==s.name&&r.push({label:t.tablename,kind:e.languages.CompletionItemKind.Class,detail:"public"!==t.schemaname?t.schemaname:null,insertText:ye(t.tablename)})})),{suggestions:r};var o=t.tableCache.find((function(e){var t,n,r=i&&i.length>a?i[a]:{};return e.schemaname==s.name&&r.isQuoted&&e.tablename===r.name||!r.isQuoted&&(null===(t=e.tablename)||void 0===t?void 0:t.toLocaleLowerCase())==(null===(n=r.name)||void 0===n?void 0:n.toLocaleLowerCase())}));o&&o.columns.forEach((function(t){r.push({label:t.attname,kind:e.languages.CompletionItemKind.Property,detail:t.data_type,insertText:ye(t.attname)})}));return{suggestions:r}}(e,t,a):function(e,t){var n,r,i,a,s=[];(null===(n=t.keywordCache)||void 0===n?void 0:n.length)>0&&t.keywordCache.forEach((function(t){s.push({label:t,kind:e.languages.CompletionItemKind.Keyword,insertText:t})}));(null===(r=t.schemaCache)||void 0===r?void 0:r.length)>0&&t.schemaCache.forEach((function(t){s.push({label:t.name,kind:e.languages.CompletionItemKind.Keyword,insertText:t.name})}));(null===(i=t.tableCache)||void 0===i?void 0:i.length)>0&&t.tableCache.forEach((function(t){var n="public"==t.schemaname?t.tablename:t.schemaname+"."+t.tablename;s.push({label:t.tablename,detail:"public"!==t.schemaname?t.schemaname:null,kind:t.is_table?e.languages.CompletionItemKind.Class:e.languages.CompletionItemKind.Interface,insertText:ye(n)}),t.columns.forEach((function(n){if(n){var r=s.find((function(t){return t.label===(null===n||void 0===n?void 0:n.attname)&&t.kind===e.languages.CompletionItemKind.Field&&t.detail===(null===n||void 0===n?void 0:n.data_type)}));r?(r.tables.push(t.tablename),r.tables.sort(),r.documentation=r.tables.join(", ")):s.push({label:n.attname,kind:e.languages.CompletionItemKind.Field,detail:n.data_type,documentation:t.tablename,tables:[t.tablename],insertText:ye(n.attname)})}}))}));(null===(a=t.functionCache)||void 0===a?void 0:a.length)>0&&t.functionCache.forEach((function(t){s.push({label:t.name,kind:e.languages.CompletionItemKind.Function,detail:t.result_type,documentation:t.description,insertText:t.name})}));return{suggestions:s}}(e,t)}catch(s){return{suggestions:[]}}}}}function ge(e){return e.replace(/^\"/,"").replace(/\"$/,"").replace(/\"\"/,'"')}function ye(e){return!(e==e.toLowerCase())?'"'.concat(e,'"'):e}var je=n(80172),ke=function(){var e=(0,p.oR)(),t=e.meta,n=e.ui.isDarkTheme,i=(0,l.JU)(),o=(0,c.Ik)();function u(e){return d.apply(this,arguments)}function d(){return(d=(0,r.Z)(a().mark((function e(n){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.formatQuery(n);case 3:if(!(r=e.sent).error){e.next=6;break}throw r.error;case 6:return e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),console.error("formatPgsql error:",e.t0),e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}return(0,s.useEffect)((function(){o&&o.editor.defineTheme("supabase",{base:n?"vs-dark":"vs",inherit:!0,rules:[{token:"",background:n?"1f1f1f":"f0f0f0"},{token:"string.sql",foreground:"24b47e"},{token:"comment",foreground:"666666"}],colors:{"editor.background":n?"#1f1f1f":"#f0f0f0"}})}),[o,n]),(0,s.useEffect)((function(){if(o){var e=o.languages.registerDocumentFormattingEditProvider("pgsql",{provideDocumentFormattingEdits:function(e){return(0,r.Z)(a().mark((function t(){var n,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getValue(),t.next=3,u(n);case 3:return r=t.sent,t.abrupt("return",[{range:e.getFullModelRange(),text:r}]);case 5:case"end":return t.stop()}}),t)})))()}}),t=o.languages.registerCompletionItemProvider("pgsql",be(o,i)),n=o.languages.registerSignatureHelpProvider("pgsql",function(e,t){return{signatureHelpTriggerCharacters:["(",","],provideSignatureHelp:function(e,n){var r=new xe(e,n.column-2,n.lineNumber-1),i=r.readArguments();if(i<0)return null;var a=r.readIdent();if(!a||a.match(/^\".*?\"$/))return null;var s=t.functionCache.find((function(e){return e.name.toLocaleLowerCase()===a.toLocaleLowerCase()}));if(!s)return null;if(!s.args||s.args.length<i)return null;var o=Math.min(i,s.args.length-1),c=[];return c.push({label:"".concat(s.name,"( ").concat(s.args.join(" , ")," )"),documentation:s.description,parameters:s.args.map((function(e){return{label:e}}))}),{value:{signatures:c,activeSignature:0,activeParameter:o},dispose:function(){}}}}}(0,i));return function(){e.dispose(),t.dispose(),n.dispose()}}}),[o]),(0,x.jsx)(x.Fragment,{children:function(){var e=i.activeTab;if(!e)return null;switch(e.type){case l.si.WELCOME:return(0,x.jsx)(g,{});case l.si.SQL_QUERY:return(0,x.jsx)("div",{className:"SQLTabContainer flex-1",children:(0,x.jsx)(Q,{})})}}()})};ke.getLayout=function(e){return(0,x.jsx)(je.Vk,{title:"SQL",children:e})};var Ne=(0,o.Pi)(ke)},44703:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/sql",function(){return n(76446)}])}},function(e){e.O(0,[5813,9731,715,7571,2036,9774,2888,179],(function(){return t=44703,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=sql-c6bd782d394ef04b.js.map