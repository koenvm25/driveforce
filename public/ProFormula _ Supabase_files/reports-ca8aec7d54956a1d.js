(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8594],{89744:function(e,t,r){"use strict";var n=r(88983),a=r(24532),s=r(24246);t.Z=function(e){var t=e.title,r=void 0===t?"":t,o=e.size,i=void 0===o?"medium":o,c=e.children,u=e.ctaButtonLabel,l=void 0===u?"":u,p=e.infoButtonLabel,d=void 0===p?"":p,f=e.infoButtonUrl,h=void 0===f?"":f,v=e.onClickCta,x=void 0===v?function(){}:v,y=e.disabled,m=void 0!==y&&y,b=e.disabledMessage,j=void 0===b?"":b,w=l&&x||h&&d;return(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,s.jsx)("div",{className:"flex space-x-4 rounded border border-panel-border-light bg-panel-body-light p-6 shadow-md dark:border-panel-border-dark dark:bg-panel-body-dark",children:(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsxs)("div",{className:"".concat("medium"===i?"w-80":"w-[400px]"," space-y-4"),children:[(0,s.jsx)("h5",{children:r}),(0,s.jsx)("div",{className:"flex flex-col space-y-2",children:c}),w&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[l&&x&&(0,s.jsxs)(a.fC,{delayDuration:0,children:[(0,s.jsx)(a.xz,{children:(0,s.jsx)(n.zxk,{type:"primary",onClick:x,disabled:m,children:l})}),m&&j.length>0&&(0,s.jsxs)(a.VY,{side:"bottom",children:[(0,s.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,s.jsx)("span",{className:"text-xs text-scale-1200",children:j})})]})]}),h&&d?(0,s.jsx)(n.zxk,{type:"default",icon:(0,s.jsx)(n.TqL,{size:14,strokeWidth:1.5}),children:(0,s.jsx)("a",{target:"_blank",href:h,children:d})}):null]})]})})})})}},50945:function(e,t,r){"use strict";r.r(t),r.d(t,{UserReportPage:function(){return j},default:function(){return w}});var n=r(55732),a=r(34707),s=r.n(a),o=r(27378),i=r(25229),c=r(86677),u=r(68043),l=r(42791),p=r(14919),d=r(20796),f=r(22375),h=r(97588),v=r(89744),x={name:"new report",description:"",type:"report",visibility:"project",content:{schema_version:1,period_start:{time_period:"7d",date:""},period_end:{time_period:"today",date:""},interval:"1d",layout:[]}},y=function(){var e=(0,n.Z)(s().mark((function e(t){var r,n,a,o,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.router,n=r.query.ref,a=(0,f.I)(n),e.next=5,a.create(x);case 5:if(o=e.sent,i=o.data,!(c=o.error)){e.next=10;break}throw c;case 10:return e.next=12,a.load();case 12:r.push("/project/".concat(n,"/reports/").concat(i[0].id));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=r(80172),b=r(24246),j=function(){var e,t,r=(0,o.useState)(!0),a=r[0],i=r[1],x=(0,c.useRouter)(),m=x.query.ref,j=(0,l.oR)().ui,w=j.selectedProject,k=(0,f.I)(m),g=(0,l.FH)(u.KA.CREATE,"user_content",{resource:{type:"report",owner_id:null===(e=j.profile)||void 0===e?void 0:e.id},subject:{id:null===(t=j.profile)||void 0===t?void 0:t.id}}),O=(0,l.P5)("initWithKps");function E(){return E=(0,n.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.load();case 2:(t=k.reports()).length>=1?x.push("/project/".concat(m,"/reports/").concat(t[0].id)):i(!1);case 4:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}return(0,o.useEffect)((function(){w&&w.status===d.S.INACTIVE&&(0,p.v_)("".concat(d.T5,"/projects/").concat(m,"/restore"),{kps_enabled:O})}),[w]),(0,o.useEffect)((function(){!function(){E.apply(this,arguments)}()}),[m]),(0,b.jsx)("div",{className:"mx-auto my-32 w-full max-w-7xl flex-grow space-y-16",children:a?(0,b.jsx)(h.Z,{}):(0,b.jsxs)(v.Z,{title:"Reports",ctaButtonLabel:"Create report",onClickCta:function(){try{y({router:x})}catch(e){j.setNotification({category:"error",message:"Failed to create report: ".concat(e.message)})}},disabled:!g,disabledMessage:"You need additional permissions to create a report",children:[(0,b.jsx)("p",{className:"text-scale-1100 text-sm",children:"Create custom reports for your projects."}),(0,b.jsx)("p",{className:"text-scale-1100 text-sm",children:"Get a high level overview of your network traffic, user actions, and infrastructure health."})]})})};j.getLayout=function(e){return(0,b.jsx)(m.li,{children:e})};var w=(0,i.Pi)(j)},22375:function(e,t,r){"use strict";r.d(t,{I:function(){return y}});var n=r(55732),a=r(43350),s=r(80040),o=r(90849),i=r(34707),c=r.n(i),u=r(79588),l=r(14919),p=r(98784),d=r(20796);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=null,x=null;function y(e){if(null===v||e!==x){x=e;var t="".concat(d.T5,"/projects/").concat(e,"/content");v=new m(t)}return v}var m=function(){function e(t){(0,a.Z)(this,e),(0,o.Z)(this,"STATES",{INITIAL:"initial",LOADING:"loading",ERROR:"error",LOADED:"loaded"}),(0,o.Z)(this,"rootStore",null),(0,o.Z)(this,"url",""),(0,o.Z)(this,"state",this.STATES.INITIAL),(0,o.Z)(this,"data",{}),(0,o.Z)(this,"error",null),this.url=t,(0,u.rC)(this,{state:u.LO,data:u.LO,list:u.LO,hasError:u.Fl,isLoading:u.Fl})}return(0,s.Z)(e,[{key:"fetchData",value:function(){var e=(0,n.Z)(c().mark((function e(){var t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={"Content-Type":"application/json"},e.next=3,(0,l.U2)(this.url,{headers:t});case 3:if(!(r=e.sent).error){e.next=6;break}throw r.error;case 6:return this.data=r.data.length>0?(0,p.keyBy)(r.data,"id"):r.data,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,n.Z)(c().mark((function e(){var t,r,n,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.STATES,r=t.LOADING,n=t.ERROR,a=t.LOADED,e.prev=1,this.error=null,this.state=r,e.next=6,this.fetchData();case 6:return this.state=a,e.abrupt("return",this.data);case 10:e.prev=10,e.t0=e.catch(1),console.error("e.message",e.t0.message),this.error=e.t0,this.state=n;case 15:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"hasError",get:function(){return this.state===this.STATES.ERROR}},{key:"isLoading",get:function(){return this.state===this.STATES.INITIAL||this.state===this.STATES.LOADING}},{key:"list",value:function(e){var t=Object.values(this.data);return e?t.filter(e).sort((function(e,t){return e.name.localeCompare(t.name)})):t.sort((function(e,t){return e.name.localeCompare(t.name)}))}},{key:"reports",value:function(e){var t=Object.values(this.data);return e?t.filter((function(e){return"report"==e.type})).filter(e).sort((function(e,t){return e.name.localeCompare(t.name)})):t.filter((function(e){return"report"==e.type})).sort((function(e,t){return e.name.localeCompare(t.name)}))}},{key:"sqlSnippets",value:function(e){var t=Object.values(this.data);return e?t.filter((function(e){return"sql"==e.type})).filter(e).sort((function(e,t){return e.name.localeCompare(t.name)})):t.filter((function(e){return"sql"==e.type})).sort((function(e,t){return e.name.localeCompare(t.name)}))}},{key:"byId",value:function(e){return this.data[e]}},{key:"create",value:function(){var e=(0,n.Z)(c().mark((function e(t){var r,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={"Content-Type":"application/json"},e.next=4,(0,l.v_)(this.url,t,{headers:r});case 4:if(!(n=e.sent).error){e.next=7;break}throw n.error;case 7:return this.data[n.id]=n,e.abrupt("return",{data:n,error:null});case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",{data:null,error:e.t0});case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=(0,n.Z)(c().mark((function e(t,r,n){var a,s,o,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={"Content-Type":"application/json"},s=h(h({},r),{},{type:n,id:t}),o="".concat(this.url,"?id=").concat(t),e.next=6,(0,l.r$)(o,s,{headers:a});case 6:if(!(i=e.sent).error){e.next=9;break}throw i.error;case 9:return this.data[t]=i,e.abrupt("return",{data:i,error:null});case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",{data:null,error:e.t0});case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"updateSql",value:function(){var e=(0,n.Z)(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.update(t,r,"sql"));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateReport",value:function(){var e=(0,n.Z)(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.update(t,r,"report"));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"del",value:function(){var e=(0,n.Z)(c().mark((function e(t){var r,n,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={"Content-Type":"application/json"},n="".concat(this.url,"?id=").concat(t),e.next=5,(0,l.$v)(n,{},{headers:r});case 5:if(!(a=e.sent).error){e.next=8;break}throw a.error;case 8:return delete this.data[t],e.abrupt("return",{data:!0,error:null});case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",{data:!1,error:e.t0});case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()},76145:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/reports",function(){return r(50945)}])}},function(e){e.O(0,[5813,9731,7571,9774,2888,179],(function(){return t=76145,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=reports-ca8aec7d54956a1d.js.map