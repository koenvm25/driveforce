"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2769],{12769:function(e,n,r){r.d(n,{IV:function(){return $e},q$:function(){return N},ny:function(){return Xe},cN:function(){return ke}});var t=r(90849),a=r(55732),i=r(34707),s=r.n(i),o=r(27378),c=r(25229),l=r(88983),d=r(68043),u=r(42791),m=r(20796),p=r(14919),h=r(96423),x=r(86677),v=r(24246),f=(0,c.Pi)((function(){var e=(0,x.useRouter)(),n=(0,u.oR)(),r=n.app,t=n.ui,i=t.selectedOrganization||{},c=i.slug,h=i.name,f=(0,o.useState)(!1),y=f[0],g=f[1],b=(0,o.useState)(""),j=b[0],w=b[1],N=(0,u.FH)(d.KA.UPDATE,"organizations"),_=function(){var n=(0,a.Z)(s().mark((function n(a,i){var o,l;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=i.setSubmitting,N){n.next=3;break}return n.abrupt("return",t.setNotification({category:"error",message:"You do not have the required permissions to delete this organization"}));case 3:return o(!0),n.next=6,(0,p.$v)("".concat(m.T5,"/organizations/").concat(c));case 6:(l=n.sent).error?(t.setNotification({category:"error",message:"Failed to delete organization: ".concat(l.error.message)}),o(!1)):(r.onOrgDeleted(t.selectedOrganization),o(!1),e.push("/"),t.setNotification({category:"success",message:"Successfully deleted ".concat(h)}));case 8:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"mt-2",children:(0,v.jsx)(l.zxk,{loading:!c,onClick:function(){return g(!0)},type:"danger",children:"Delete organization"})}),(0,v.jsx)(l.u_l,{closable:!0,hideFooter:!0,size:"small",visible:y,onCancel:function(){return g(!1)},header:(0,v.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,v.jsx)("h5",{className:"text-sm text-scale-1200",children:"Delete organisation"}),(0,v.jsx)("span",{className:"text-xs text-scale-900",children:"Are you sure?"})]}),children:(0,v.jsx)(l.l09,{validateOnBlur:!0,initialValues:{orgName:""},onSubmit:_,validate:function(e){var n={};return e.orgName||(n.orgName="Enter the name of the organization."),e.orgName!==c&&(n.orgName="Value entered does not match the value above."),n},children:function(e){var n=e.isSubmitting;return(0,v.jsxs)("div",{className:"space-y-4 py-3",children:[(0,v.jsx)(l.u_l.Content,{children:(0,v.jsxs)("p",{className:"text-sm text-scale-900",children:["This action ",(0,v.jsx)("span",{className:"text-scale-1200",children:"cannot"})," be undone. This will permanently delete the ",(0,v.jsx)("span",{className:"text-scale-1200",children:h})," ","organization and remove all of its projects."]})}),(0,v.jsx)(l.u_l.Separator,{}),(0,v.jsx)(l.u_l.Content,{children:(0,v.jsx)(l.IIB,{id:"orgName",label:(0,v.jsxs)("span",{children:["Please type ",(0,v.jsx)("span",{className:"font-bold",children:c})," to confirm"]}),onChange:function(e){return w(e.target.value)},value:j,placeholder:"Enter the string above",className:"w-full"})}),(0,v.jsx)(l.u_l.Separator,{}),(0,v.jsx)(l.u_l.Content,{children:(0,v.jsx)(l.zxk,{block:!0,danger:!0,size:"small",type:"danger",htmlType:"submit",loading:n,children:"I understand, delete this organization"})})]})}})})]})})),y=f,g=(0,c.Pi)((function(){return(0,v.jsx)(h.Z,{title:(0,v.jsx)("p",{className:"uppercase",children:"Danger Zone"},"panel-title"),children:(0,v.jsx)(h.Z.Content,{children:(0,v.jsxs)(l.bZj,{withIcon:!0,variant:"danger",title:(0,v.jsx)("span",{className:"text-red-900",children:"Deleting this organization will also remove its projects"}),children:[(0,v.jsx)("p",{className:"text-red-900",children:"Make sure you have made a backup if you want to keep your data"}),(0,v.jsx)(y,{})]})})})})),b=r(33003);function j(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function w(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?j(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var N=(0,c.Pi)((function(){var e,n,r=(0,u.oR)(),t=r.app,i=r.ui,c=(0,u.UO)().slug,h="org-general-settings",x={name:null!==(e=null===(n=i.selectedOrganization)||void 0===n?void 0:n.name)&&void 0!==e?e:""},f=(0,u.FH)(d.KA.UPDATE,"organizations"),y=(0,u.FH)(d.KA.UPDATE,"organizations"),j=function(){var e=(0,a.Z)(s().mark((function e(n,r){var a,o,l,d,u,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=r.setSubmitting,d=r.resetForm,f){e.next=3;break}return e.abrupt("return",i.setNotification({category:"error",message:"You do not have the required permissions to update this organization"}));case 3:return l(!0),e.next=6,(0,p.r$)("".concat(m.T5,"/organizations/").concat(c),w(w({},n),{},{billing_email:null!==(a=null===(o=i.selectedOrganization)||void 0===o?void 0:o.billing_email)&&void 0!==a?a:""}));case 6:(u=e.sent).error?i.setNotification({category:"error",message:"Failed to update organization: ".concat(u.error.message)}):(h=u.name,d({values:{name:h},initialValues:{name:h}}),t.onOrgUpdated(u),i.setNotification({category:"success",message:"Successfully saved settings"})),l(!1);case 9:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}();return(0,v.jsxs)("div",{className:"container my-4 max-w-4xl space-y-8",children:[(0,v.jsx)(l.l09,{id:h,initialValues:x,onSubmit:j,children:function(e){var n,r=e.isSubmitting,t=e.handleReset,a=e.values,s=e.initialValues,c=e.resetForm,d=JSON.stringify(a)!==JSON.stringify(s);return(0,o.useEffect)((function(){var e,n,r={name:null!==(e=null===(n=i.selectedOrganization)||void 0===n?void 0:n.name)&&void 0!==e?e:""};c({values:r,initialValues:r})}),[null===(n=i.selectedOrganization)||void 0===n?void 0:n.slug]),(0,v.jsx)(b.by,{footer:(0,v.jsx)("div",{className:"flex py-4 px-8",children:(0,v.jsx)(b.iN,{form:h,isSubmitting:r,hasChanges:d,handleReset:t,helper:f?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,v.jsx)(b.hj,{header:(0,v.jsx)(b.S0,{children:"Organization name"}),children:(0,v.jsx)(b.B4,{loading:!1,children:(0,v.jsx)(l.IIB,{id:"name",size:"small",disabled:!f})})})})}}),y&&(0,v.jsx)(g,{})]})})),_=r(24532),O=r(98784),C=r(14633),S=r(90089),k=r(85945),P=r(48228),T=r(61276),A=["onSuccess"];function I(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function E(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?I(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function z(e){return D.apply(this,arguments)}function D(){return(D=(0,a.Z)(s().mark((function e(n){var r,t,a,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.invitedEmail,a=n.ownerId,i=n.roleId,e.next=3,(0,p.v_)("".concat(m.T5,"/organizations/").concat(r,"/members/invite"),{invited_email:t,owner_id:a,role_id:i});case 3:if(!(o=e.sent).error){e.next=6;break}throw o.error;case 6:return e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=(0,S.Z)(e,A),t=(0,k.NL)();return(0,P.D)((function(e){return z(e)}),E({onSuccess:function(e,r,i){return(0,a.Z)(s().mark((function a(){var o;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=r.slug,a.next=3,Promise.all([t.invalidateQueries(T.O.detail(o)),t.invalidateQueries(T.O.roles(o))]);case 3:return a.next=5,null===n||void 0===n?void 0:n(e,r,i);case 5:case"end":return a.stop()}}),a)})))()}},r))};function R(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function M(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?R(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var F=function(e){var n=e.user,r=e.members,t=void 0===r?[]:r,i=e.roles,c=void 0===i?[]:i,m=e.rolesAddable,p=void 0===m?[]:m,h=(0,u.oR)().ui,x=(0,u.UO)().slug,f=(0,o.useState)(!1),y=f[0],g=f[1],b=c.some((function(e){var n=e.id;return(0,u.FH)(d.KA.CREATE,"user_invites",{resource:{role_id:n}})})),j={email:"",role:""},w=(0,C.object)({email:(0,C.string)().email("Must be a valid email address").required("Email is required"),role:(0,C.string)().required("Role is required")}),N=Z().mutateAsync,S=function(){var e=(0,a.Z)(s().mark((function e(r,a){var i,o,c,l,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.setSubmitting,o=a.resetForm,x){e.next=3;break}throw new Error("slug is required");case 3:if(void 0===(c=t.find((function(e){return e.primary_email===r.email.toLowerCase()})))){e.next=10;break}if(!c.invited_id){e.next=9;break}return e.abrupt("return",h.setNotification({category:"info",message:"User has already been invited to this organization"}));case 9:return e.abrupt("return",h.setNotification({category:"info",message:"User is already in this organization"}));case 10:return l=Number(r.role),i(!0),e.prev=12,e.next=15,N({slug:x,invitedEmail:r.email.toLowerCase(),ownerId:n.id,roleId:l});case 15:d=e.sent,(0,O.isNil)(d)?h.setNotification({category:"error",message:"Failed to add member"}):(h.setNotification({category:"success",message:"Successfully added new member."}),g(!y),o({initialValues:M(M({},j),{},{role:l})})),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(12),h.setNotification({category:"error",message:"Failed to add member: ".concat(e.t0.message)});case 22:i(!1);case 23:case"end":return e.stop()}}),e,null,[[12,19]])})));return function(n,r){return e.apply(this,arguments)}}();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(_.fC,{delayDuration:0,children:[(0,v.jsx)(_.xz,{children:(0,v.jsx)(l.zxk,{disabled:!b,onClick:function(){return g(!0)},children:"Invite"})}),!b&&(0,v.jsxs)(_.VY,{side:"bottom",children:[(0,v.jsx)(_.Eh,{className:"radix-tooltip-arrow"}),(0,v.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,v.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to invite a member to this organization"})})]})]}),(0,v.jsx)(l.u_l,{hideFooter:!0,size:"medium",layout:"vertical",className:"!overflow-visible",visible:y,onCancel:function(){return g(!1)},header:"Invite a member to this organization",children:(0,v.jsx)(l.l09,{validationSchema:w,initialValues:j,onSubmit:S,children:function(e){var n=e.values,r=e.isSubmitting,t=e.resetForm;(0,o.useEffect)((function(){var e,n;c&&t({values:M(M({},j),{},{role:null===(e=c.find((function(e){return"Developer"===e.name})))||void 0===e?void 0:e.id}),initialValues:M(M({},j),{},{role:null===(n=c.find((function(e){return"Developer"===e.name})))||void 0===n?void 0:n.id})})}),[c]);var a=c.find((function(e){return e.id===Number(n.role)})),i=n.role&&!p.includes(Number(n.role));return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(l.u_l.Content,{children:(0,v.jsx)("div",{className:"w-full py-4",children:(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsx)("div",{className:"space-y-2",children:c&&(0,v.jsx)(l.PhF,{id:"role",name:"role",label:"Member role",error:i?"You need additional permissions to assign users the role of ".concat(null===a||void 0===a?void 0:a.name):"",children:c.map((function(e){return(0,v.jsx)(l.PhF.Option,{value:e.id,children:e.name},e.id)}))})}),(0,v.jsx)(l.IIB,{autoFocus:!0,id:"email",icon:(0,v.jsx)(l.haR,{}),placeholder:"Enter email address",label:"Email address"})]})})}),(0,v.jsx)(l.u_l.Separator,{}),(0,v.jsx)(l.u_l.Content,{children:(0,v.jsx)("div",{className:"pt-2 pb-3",children:(0,v.jsx)(l.zxk,{block:!0,size:"medium",htmlType:"submit",disabled:r||i,loading:r,children:"Invite new member"})})})]})}})})]})},B=r(11246),L=r(44285),V=r(38579);function G(e){var n=new Date(e);return!(((new Date).valueOf()-n.valueOf())/1e3/60/60<24)}var U=function(e){if(!e)return"";var n=e||{},r=n.username,t=n.primary_email;return void 0!==n.invited_id?t:r||""},K=r(55671),H=r(44266),Y=["onSuccess"];function W(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function q(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?W(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function J(e){return Q.apply(this,arguments)}function Q(){return(Q=(0,a.Z)(s().mark((function e(n){var r,t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.gotrueId,e.next=3,(0,p.$v)("".concat(m.T5,"/organizations/").concat(r,"/members/").concat(t));case 3:if(!(a=e.sent).error){e.next=6;break}throw a.error;case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $=["onSuccess"];function X(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function ee(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?X(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ne(e){return re.apply(this,arguments)}function re(){return(re=(0,a.Z)(s().mark((function e(n){var r,t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.invitedId,e.next=3,(0,p.$v)("".concat(m.T5,"/organizations/").concat(r,"/members/invite?invited_id=").concat(t),{});case 3:if(!(a=e.sent).error){e.next=6;break}throw a.error;case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=(0,S.Z)(e,$),t=(0,k.NL)();return(0,P.D)((function(e){return ne(e)}),ee({onSuccess:function(e,r,i){return(0,a.Z)(s().mark((function a(){var o;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=r.slug,a.next=3,Promise.all([t.invalidateQueries(T.O.detail(o)),t.invalidateQueries(T.O.roles(o))]);case 3:return a.next=5,null===n||void 0===n?void 0:n(e,r,i);case 5:case"end":return a.stop()}}),a)})))()}},r))},ae=function(e){var n=[],r=[];return e?(e.forEach((function(e){(0,u.FH)(d.KA.CREATE,"auth.subject_roles",{resource:{role_id:e.id}})&&n.push(e.id),(0,u.FH)(d.KA.DELETE,"auth.subject_roles",{resource:{role_id:e.id}})&&r.push(e.id)})),{rolesAddable:n,rolesRemovable:r}):{rolesAddable:n,rolesRemovable:r}},ie=(0,c.Pi)((function(e){e.members;var n,r,t,i,o=e.member,c=e.roles,m=(0,u.oR)().ui,p=(0,u.UO)().slug,h=ae(c).rolesRemovable,x=G(null!==(n=null===o||void 0===o?void 0:o.invited_at)&&void 0!==n?n:""),f=o.invited_id,y=null!==(r=null===(t=o.role_ids)||void 0===t?void 0:t[0])&&void 0!==r?r:-1,g=h.includes((null!==(i=null===o||void 0===o?void 0:o.role_ids)&&void 0!==i?i:[-1])[0]),b=(0,u.FH)(d.KA.CREATE,"user_invites",{resource:{role_id:y}}),j=(0,u.FH)(d.KA.DELETE,"user_invites",{resource:{role_id:y}}),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=(0,S.Z)(e,Y),t=(0,k.NL)();return(0,P.D)((function(e){return J(e)}),q({onSuccess:function(e,r,i){return(0,a.Z)(s().mark((function a(){var o;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=r.slug,a.next=3,Promise.all([t.invalidateQueries(T.O.detail(o)),t.invalidateQueries(T.O.roles(o))]);case 3:return a.next=5,null===n||void 0===n?void 0:n(e,r,i);case 5:case"end":return a.stop()}}),a)})))()}},r))}({onSuccess:function(){m.setNotification({category:"success",message:"Successfully removed ".concat(o.primary_email)})},onError:function(e){m.setNotification({category:"error",message:"Failed to delete user: ".concat(e.message)})}}),N=w.mutateAsync,O=w.isLoading,C=function(){var e=(0,a.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,H._)({title:"Confirm to remove",message:"This is permanent! Are you sure you want to remove ".concat(o.primary_email),onAsyncConfirm:function(){var e=(0,a.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=2;break}throw new Error("slug is required");case 2:if(o.gotrue_id){e.next=4;break}throw new Error("gotrue_id is required");case 4:return e.next=6,N({slug:p,gotrueId:o.gotrue_id});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=Z({onSuccess:function(){m.setNotification({category:"success",message:"Resent the invitation."})},onError:function(e){m.setNotification({category:"error",message:"Failed to resend invitation: ".concat(e.message)})}}),I=A.mutate,E=A.isLoading;function z(){return z=(0,a.Z)(s().mark((function e(n){var r,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.invited_id&&p){e.next=2;break}return e.abrupt("return");case 2:t=(null!==(r=null===n||void 0===n?void 0:n.role_ids)&&void 0!==r?r:[])[0],I({slug:p,invitedEmail:n.primary_email,ownerId:n.invited_id,roleId:t});case 4:case"end":return e.stop()}}),e)}))),z.apply(this,arguments)}var D=te({onSuccess:function(){m.setNotification({category:"success",message:"Successfully revoked the invitation."})},onError:function(e){m.setNotification({category:"error",message:"Failed to revoke invitation: ".concat(e.message)})}}),R=D.mutate,M=D.isLoading;if(!g||f&&!b&&!j)return(0,v.jsx)("div",{className:"flex items-center justify-end",children:(0,v.jsxs)(_.fC,{delayDuration:0,children:[(0,v.jsx)(_.xz,{children:(0,v.jsx)(l.zxk,{as:"span",type:"text",icon:(0,v.jsx)(l.q3n,{})})}),(0,v.jsxs)(_.VY,{side:"bottom",children:[(0,v.jsx)(_.Eh,{className:"radix-tooltip-arrow"}),(0,v.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 "].join(" "),children:(0,v.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to manage this team member"})})]})]})});var F=O||M||E;return(0,v.jsx)("div",{className:"flex items-center justify-end",children:(0,v.jsx)(l.Ltx,{side:"bottom",align:"end",size:"small",overlay:(0,v.jsx)(v.Fragment,{children:f?(0,v.jsxs)(v.Fragment,{children:[j&&(0,v.jsx)(l.Ltx.Item,{onClick:function(){return function(e){var n=e.invited_id;n&&p&&R({slug:p,invitedId:n})}(o)},children:(0,v.jsxs)("div",{className:"flex flex-col",children:[(0,v.jsx)("p",{children:"Cancel invitation"}),(0,v.jsx)("p",{className:"block opacity-50",children:"Revoke this invitation."})]})}),b&&x&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(l.Ltx.Separator,{}),(0,v.jsx)(l.Ltx.Item,{onClick:function(){return function(e){return z.apply(this,arguments)}(o)},children:(0,v.jsxs)("div",{className:"flex flex-col",children:[(0,v.jsx)("p",{children:"Resend invitation"}),(0,v.jsx)("p",{className:"block opacity-50",children:"Invites expire after 24hrs."})]})})]})]}):(0,v.jsx)(l.Ltx.Item,{icon:(0,v.jsx)(l.IT9,{size:16}),onClick:C,children:(0,v.jsx)("p",{children:"Remove member"})})}),children:(0,v.jsx)(l.zxk,{as:"span",type:"text",disabled:F,loading:F,icon:(0,v.jsx)(l.q3n,{})})})})})),se=r(79305),oe=[{title:"Organization",actions:[{description:"Can change organization name",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}},{description:"Can delete organization",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}}]},{title:"Members",actions:[{description:"Can add an Owner",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}},{description:"Can remove an Owner",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}},{description:"Can add an Adminstrator",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can remove an Administrator",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can add a Developer",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can remove a Developer",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can revoke an invite",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can resend an invite",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}}]},{title:"Billing",actions:[{description:"Can read invoices",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can read billing email",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can change billing email",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!0}},{description:"Can view subscription",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update subscription",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}},{description:"Can read billing address",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update billing address",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}},{description:"Can read tax codes",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update tax codes",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}},{description:"Can read payment methods",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update payment methods",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}}]},{title:"Projects",actions:[{description:"Can view projects",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can delete a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can update a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can pause a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can resume a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can restart a project",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read API anon keys",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can read API secret keys",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read JWT secret",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can generate new JWT secret",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can update API settings",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]},{title:"Database",actions:[{description:"Can read tables",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete tables",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read RLS policies",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can read create/update/delete RLS policies",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database extensions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can read update database extensions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read scheduled database backups",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can trigger a scheduled database backup",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read PITR database backups",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can trigger a PITR database backup",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database replications",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can update database replications",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database triggers",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete database triggers",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database functions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete database functions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database webhooks",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete database webhooks",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]},{title:"SQL Editor",actions:[{description:"Can run a SELECT-based query",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can run all other types of queries",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can create/update/delete queries",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Storage",actions:[{description:"Can access storage",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]},{title:"Authentication",actions:[{description:"Can view users",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can remove users",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can invite users",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read authentication settings",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can update authentication settings",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can view authentication logs",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Edge Functions",actions:[{description:"Can view edge functions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Logs Explorer",actions:[{description:"Can view logs explorer",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create queries in the logs explorer",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Reports",actions:[{description:"Can view reports",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update a report",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]}],ce=function(e){(0,se.Z)(e);var n=(0,o.useState)(!1),r=n[0],t=n[1],a="w-[40%] text-sm pl-4 font-bold",i="w-[12%] text-sm h-8 flex items-center justify-center border-l border-scale-600 font-bold",s=(0,v.jsxs)(_.fC,{delayDuration:0,children:[(0,v.jsx)(_.xz,{children:(0,v.jsx)(l.aUG,{size:14,strokeWidth:2})}),(0,v.jsxs)(_.VY,{side:"top",children:[(0,v.jsx)(_.Eh,{className:"radix-tooltip-arrow"}),(0,v.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 "].join(" "),children:(0,v.jsx)("span",{className:"text-xs text-scale-1200",children:"Only available in Team/Enterprise plan."})})]})]});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(l.Sus,{size:16,strokeWidth:1.5,className:"cursor-pointer transition hover:text-scale-1200",onClick:function(){return t(!r)}}),(0,v.jsx)(l.u_l,{closable:!0,hideFooter:!0,visible:r,size:"xxlarge",header:"Permissions for each role",onCancel:function(){return t(!r)},children:(0,v.jsxs)("div",{className:"space-y-4 py-4",children:[(0,v.jsx)(l.u_l.Content,{children:(0,v.jsx)("p",{className:"text-sm",children:"The following table shows the corresponding permissions for each available role in the dashboard."})}),(0,v.jsx)(l.u_l.Content,{children:(0,v.jsxs)("div",{className:"rounded border border-scale-500 bg-scale-400",children:[(0,v.jsxs)("div",{className:"flex items-center border-b border-scale-600",children:[(0,v.jsx)("div",{className:a,children:"Permissions"}),(0,v.jsx)("div",{className:i,children:"Owner"}),(0,v.jsx)("div",{className:i,children:"Adminstrator"}),(0,v.jsx)("div",{className:i,children:"Developer"}),(0,v.jsxs)("div",{className:i,children:["Read-only\xa0",s]}),(0,v.jsxs)("div",{className:i,children:["Billing-only\xa0",s]})]}),(0,v.jsx)("div",{className:"max-h-[425px] overflow-y-auto",children:oe.map((function(e){return(0,v.jsxs)(o.Fragment,{children:[(0,v.jsx)("div",{className:"flex items-center border-b border-scale-600 py-2 px-4 last:border-none",children:(0,v.jsx)("div",{className:"w-[100%] text-sm",children:e.title})}),e.actions.map((function(n,r){return(0,v.jsxs)("div",{className:"flex items-center border-b border-scale-600 bg-scale-500 last:border-none",children:[(0,v.jsx)("div",{className:a,children:n.description}),(0,v.jsx)("div",{className:i,children:n.permissions.owner&&(0,v.jsx)(l.NOm,{size:14,strokeWidth:2})}),(0,v.jsx)("div",{className:i,children:n.permissions.admin&&(0,v.jsx)(l.NOm,{size:14,strokeWidth:2})}),(0,v.jsx)("div",{className:i,children:n.permissions.developer&&(0,v.jsx)(l.NOm,{size:14,strokeWidth:2})}),(0,v.jsx)("div",{className:i,children:n.permissions.read_only&&(0,v.jsx)(l.NOm,{size:14,strokeWidth:2})}),(0,v.jsx)("div",{className:i,children:n.permissions.billing_only&&(0,v.jsx)(l.NOm,{size:14,strokeWidth:2})})]},"".concat(e.title,"-").concat(r))}))]},e.title)}))})]})})]})})]})},le=["onSuccess"];function de(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function ue(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?de(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function me(e){return pe.apply(this,arguments)}function pe(){return(pe=(0,a.Z)(s().mark((function e(n){var r,t,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.gotrueId,a=n.roleId,e.next=3,(0,p.r$)("".concat(m.T5,"/organizations/").concat(r,"/members/").concat(t),{role_id:a});case 3:if(!(i=e.sent).error){e.next=6;break}throw i.error;case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function xe(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?he(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var ve=(0,c.Pi)((function(e){var n=e.searchString,r=e.roles,t=e.members,i=(0,u.oR)().ui,c=(0,u.UO)().slug,d=i.profile,m=ae(r),p=m.rolesAddable,h=m.rolesRemovable,x=(0,o.useState)(),f=x[0],y=x[1],g=(0,o.useState)(!1),b=g[0],j=g[1];if(!t)return(0,v.jsx)("div",{});var w=(n?t.filter((function(e){return e.invited_at?e.primary_email.includes(n):e.id||e.gotrue_id?e.username.includes(n)||e.primary_email.includes(n):void 0})):t).slice().sort((function(e,n){return e.username.localeCompare(n.username)})),N=function(e){var n;return r?null===(n=r.find((function(n){return n.id===e})))||void 0===n?void 0:n.name:e},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=(0,S.Z)(e,le),t=(0,k.NL)();return(0,P.D)((function(e){return me(e)}),ue({onSuccess:function(e,r,i){return(0,a.Z)(s().mark((function a(){var o;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=r.slug,a.next=3,Promise.all([t.invalidateQueries(T.O.detail(o)),t.invalidateQueries(T.O.roles(o))]);case 3:return a.next=5,null===n||void 0===n?void 0:n(e,r,i);case 5:case"end":return a.stop()}}),a)})))()}},r))}({onSuccess:function(){i.setNotification({category:"success",message:"Successfully updated role for ".concat(U(f))})},onError:function(){i.setNotification({category:"error",message:"Failed to update role for ".concat(U(f))})}}),C=O.isLoading,A=O.mutate,I=function(){var e=(0,a.Z)(s().mark((function e(){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=2;break}return e.abrupt("return");case 2:if(n=f.gotrue_id,r=f.newRoleId,c){e.next=5;break}throw new Error("slug is required");case 5:if(n){e.next=7;break}throw new Error("gotrue_id is required");case 7:A({slug:c,gotrueId:n,roleId:r}),j(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"rounded",children:(0,v.jsx)(l.gbz,{active:!w,children:(0,v.jsx)(K.Z,{head:[(0,v.jsx)(K.Z.th,{children:"User"},"header-user"),(0,v.jsx)(K.Z.th,{},"header-status"),(0,v.jsxs)(K.Z.th,{className:"flex items-center space-x-2",children:[(0,v.jsx)("span",{children:"Role"}),(0,v.jsx)(ce,{})]},"header-role"),(0,v.jsx)(K.Z.th,{},"header-action")],body:[].concat((0,L.Z)(w.map((function(e,n){var a,s=null!==(a=e.role_ids)&&void 0!==a?a:[],c=(0,B.Z)(s,1)[0],u=(r||[]).find((function(e){return e.id===c})),m=e.primary_email==(null===d||void 0===d?void 0:d.primary_email),x=!!e.invited_id,f=h.includes(c),g=!f||m||x,b=e.username===e.primary_email;return(0,v.jsx)(o.Fragment,{children:(0,v.jsxs)(K.Z.tr,{children:[(0,v.jsx)(K.Z.td,{children:(0,v.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,v.jsx)("div",{children:e.invited_id?(0,v.jsx)("span",{className:"flex p-2 border-2 rounded-full border-border-secondary-light dark:border-border-secondary-dark",children:(0,v.jsx)(l.f7T,{size:20,strokeWidth:2})}):b?(0,v.jsx)("div",{className:"w-[40px] h-[40px] bg-scale-300 border border-scale-400 rounded-full text-scale-900 flex items-center justify-center",children:(0,v.jsx)(l.f7T,{strokeWidth:1.5})}):(0,v.jsx)(V.default,{src:"https://github.com/".concat(e.username,".png?size=80"),width:"40",height:"40",className:"border rounded-full"})}),(0,v.jsxs)("div",{children:[(0,v.jsx)("p",{className:"text-scale-1200",children:U(e)}),void 0===e.invited_id&&(0,v.jsx)("p",{className:"text-scale-1100",children:e.primary_email})]})]})}),(0,v.jsx)(K.Z.td,{children:e.invited_id&&e.invited_at&&(0,v.jsx)(l.Cts,{color:G(e.invited_at)?"red":"yellow",children:G(e.invited_at)?"Expired":"Invited"})}),(0,v.jsxs)(K.Z.td,{children:[!u&&(0,v.jsx)("p",{children:e.is_owner?"Owner":"Developer"}),u&&(0,v.jsxs)(_.fC,{delayDuration:0,children:[(0,v.jsx)(_.xz,{children:(0,v.jsx)(l.RiT,{className:g?"pointer-events-none":"",disabled:g,value:u.id,onChange:function(n){var t;if(u&&u.id!==n){var a=(r||[]).find((function(e){return e.id===n}));if(!p.includes(null!==(t=null===a||void 0===a?void 0:a.id)&&void 0!==t?t:-1))return i.setNotification({category:"error",duration:4e3,message:"You do not have permission to update this team member to ".concat(a.name)});j(!0),y(xe(xe({},e),{},{oldRoleId:u.id,newRoleId:n}))}},children:r.map((function(e){return(0,v.jsx)(l.RiT.Option,{value:e.id,label:e.name,disabled:g,children:e.name},e.id)}))})}),x?(0,v.jsxs)(_.VY,{side:"bottom",children:[(0,v.jsx)(_.Eh,{className:"radix-tooltip-arrow"}),(0,v.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 "].join(" "),children:(0,v.jsx)("span",{className:"text-xs text-scale-1200",children:"Role can only be changed after the user has accepted the invite"})})]}):m||f?(0,v.jsx)(v.Fragment,{}):(0,v.jsxs)(_.VY,{side:"bottom",children:[(0,v.jsx)(_.Eh,{className:"radix-tooltip-arrow"}),(0,v.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 "].join(" "),children:(0,v.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to manage this team member"})})]})]})]}),(0,v.jsx)(K.Z.td,{children:!m&&(0,v.jsx)(ie,{members:t,member:e,roles:r})})]})},"member-row-".concat(n))}))),(0,L.Z)(n.length>0&&0===w.length?[(0,v.jsx)(K.Z.tr,{className:"bg-panel-secondary-light dark:bg-panel-secondary-dark",children:(0,v.jsx)(K.Z.td,{colSpan:12,children:(0,v.jsxs)("div",{className:"flex items-center space-x-3 opacity-75",children:[(0,v.jsx)(l.Ldj,{size:16,strokeWidth:2}),(0,v.jsxs)("p",{className:"text-scale-1100",children:['No users matched the search query "',n,'"']})]})})},"no-results")]:[]),[(0,v.jsx)(K.Z.tr,{className:"bg-panel-secondary-light dark:bg-panel-secondary-dark",children:(0,v.jsx)(K.Z.td,{colSpan:4,children:(0,v.jsxs)("p",{className:"text-scale-1100",children:[n?"".concat(w.length," of "):"",t.length||"0"," ",1==t.length?"user":"users"]})})},"footer")])})})}),(0,v.jsx)(l.u_l,{hideFooter:!0,size:"medium",visible:b,onCancel:function(){return j(!1)},header:"Change role of member",children:(0,v.jsxs)("div",{className:"flex flex-col gap-2 py-4",children:[(0,v.jsxs)(l.u_l.Content,{children:[(0,v.jsxs)("p",{className:"text-sm text-scale-1100",children:["You are changing the role of"," ",(0,v.jsx)("span",{className:"text-scale-1200",children:U(f)})," from"," ",(0,v.jsx)("span",{className:"text-scale-1200",children:N(null===f||void 0===f?void 0:f.oldRoleId)})," ","to"," ",(0,v.jsx)("span",{className:"text-scale-1200",children:N(null===f||void 0===f?void 0:f.newRoleId)})]}),(0,v.jsx)("p",{className:"mt-3 text-sm text-scale-1200",children:"By changing the role of this member their permissions will change."})]}),(0,v.jsx)(l.u_l.Separator,{}),(0,v.jsx)(l.u_l.Content,{children:(0,v.jsxs)("div",{className:"flex gap-3",children:[(0,v.jsx)(l.zxk,{type:"default",block:!0,size:"medium",onClick:function(){return j(!1)},children:"Cancel"}),(0,v.jsx)(l.zxk,{block:!0,type:"warning",size:"medium",disabled:C,loading:C,onClick:function(){return I()},children:"Confirm"})]})})]})})]})})),fe=r(36492),ye=["enabled"];function ge(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function be(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ge(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function je(e,n){return we.apply(this,arguments)}function we(){return(we=(0,a.Z)(s().mark((function e(n,r){var t,a,i,o,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.slug){e.next=3;break}throw new Error("slug is required");case 3:return e.next=5,Promise.all([(0,p.U2)("".concat(m.T5,"/organizations/").concat(t,"/members?member_roles"),{signal:r}),(0,p.U2)("".concat(m.T5,"/organizations/").concat(t,"/members/invite"),{signal:r})]);case 5:if(a=e.sent,i=(0,B.Z)(a,2),o=i[0],c=i[1],!o.error){e.next=11;break}throw o.error;case 11:if(!c.error){e.next=13;break}throw c.error;case 13:return o&&c&&c.length>0&&(l=c.map((function(e){return be(be({},{is_owner:!1,invited_at:e.invited_at,invited_id:e.invited_id,username:e.invited_email.slice(0,1),primary_email:e.invited_email}),{},{role_ids:[e.role_id]})})),o=[].concat((0,L.Z)(o),(0,L.Z)(l))),e.abrupt("return",{members:o});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ne=["enabled"];function _e(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function Oe(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?_e(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_e(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Ce(e,n){return Se.apply(this,arguments)}function Se(){return(Se=(0,a.Z)(s().mark((function e(n,r){var t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.slug){e.next=3;break}throw new Error("slug is required");case 3:return e.next=5,(0,p.U2)("".concat(m.T5,"/organizations/").concat(t,"/roles"),{signal:r});case 5:if(!(a=e.sent).error){e.next=8;break}throw a.error;case 8:return e.abrupt("return",{roles:a});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ke=(0,c.Pi)((function(){var e,n,r,t=(0,u.oR)().ui,i=(0,u.UO)().slug,c=t.profile,d=null===(e=t.selectedOrganization)||void 0===e?void 0:e.is_owner,h=function(e){var n=e.slug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,a=void 0===t||t,i=(0,S.Z)(r,ye);return(0,fe.a)(T.O.detail(n),(function(e){var r=e.signal;return je({slug:n},r)}),be({enabled:a&&"undefined"!==typeof n},i))}({slug:i}),x=h.data,f=function(e){var n=e.slug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,a=void 0===t||t,i=(0,S.Z)(r,Ne);return(0,fe.a)(T.O.roles(n),(function(e){var r=e.signal;return Ce({slug:n},r)}),Oe({enabled:a&&"undefined"!==typeof n},i))}({slug:i}),y=f.data,g=null!==(n=null===x||void 0===x?void 0:x.members)&&void 0!==n?n:[],b=null!==(r=null===y||void 0===y?void 0:y.roles)&&void 0!==r?r:[],j=ae(b).rolesAddable,w=(0,o.useState)(!1),N=w[0],O=w[1],C=(0,o.useState)(""),k=C[0],P=C[1],A=j.length>0,I=!d||d&&function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(n){var r,t=null!==(r=n.role_ids)&&void 0!==r?r:[],a=(0,B.Z)(t,1)[0],i=e.find((function(e){return e.id===a}));return"Owner"===(null===i||void 0===i?void 0:i.name)&&!n.invited_at})).length>1}(g,b),E=function(){var e=(0,a.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(!0);try{(0,H._)({title:"Are you sure?",message:"Are you sure you want to leave this team? This is permanent.",onAsyncConfirm:function(){var e=(0,a.Z)(s().mark((function e(){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.v_)("".concat(m.T5,"/organizations/").concat(i,"/members/leave"),{});case 2:if(!(n=e.sent).error){e.next=7;break}throw n.error;case 7:null===(r=window)||void 0===r||r.location.replace("/");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}catch(n){t.setNotification({category:"error",message:"Error leaving: ".concat(null===n||void 0===n?void 0:n.message)})}finally{O(!1)}case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"container my-4 max-w-4xl space-y-8",children:(0,v.jsxs)("div",{className:"flex justify-between",children:[(0,v.jsx)(l.IIB,{icon:(0,v.jsx)(l.jVj,{size:"tiny"}),size:"small",value:k,onChange:function(e){return P(e.target.value)},name:"email",id:"email",placeholder:"Filter members"}),(0,v.jsxs)("div",{className:"flex items-center space-x-4",children:[A&&void 0!==c&&(0,v.jsx)("div",{children:(0,v.jsx)(F,{user:c,members:g,roles:b,rolesAddable:j})}),(0,v.jsx)("div",{children:(0,v.jsxs)(_.fC,{delayDuration:0,children:[(0,v.jsx)(_.xz,{children:(0,v.jsx)(l.zxk,{type:"default",disabled:!I,onClick:function(){return E()},loading:N,children:"Leave team"})}),!I&&(0,v.jsxs)(_.VY,{side:"bottom",children:[(0,v.jsx)(_.Eh,{className:"radix-tooltip-arrow"}),(0,v.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,v.jsx)("span",{className:"text-xs text-scale-1200",children:"An organization requires at least 1 owner"})})]})]})})]})]})}),(0,v.jsx)("div",{className:"container my-4 max-w-4xl space-y-8",children:(0,v.jsx)(ve,{searchString:k,roles:b,members:g})})]})})),Pe=r(79894),Te=r(27693),Ae=r.n(Te),Ie=r(51896),Ee=function(e){var n,r,t,a,i,s=e.project,c=(0,u.oR)().ui,d=(0,Ie.S2)({projectRef:s.ref}),m=d.data,p=d.isLoading,h=d.error,x=null!==(n=null===m||void 0===m||null===(r=m.billing)||void 0===r?void 0:r.current_period_start)&&void 0!==n?n:0,f=null!==(t=null===m||void 0===m||null===(a=m.billing)||void 0===a?void 0:a.current_period_end)&&void 0!==t?t:0;return(0,o.useEffect)((function(){var e;h&&c.setNotification({category:"error",message:"Failed to get project subscription: ".concat(null!==(e=null===h||void 0===h?void 0:h.message)&&void 0!==e?e:"unknown")})}),[h]),(0,v.jsxs)("div",{className:"flex items-center w-full px-6 py-3",children:[(0,v.jsx)("div",{className:"w-[25%]",children:(0,v.jsx)("p",{className:"text-sm",children:s.name})}),p?(0,v.jsx)("div",{className:"flex w-[75%] items-center justify-center",children:(0,v.jsx)(l.pAw,{size:14,className:"animate-spin"})}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"w-[20%]",children:(0,v.jsx)("p",{className:"text-sm",children:null!==(i=null===m||void 0===m?void 0:m.tier.name)&&void 0!==i?i:""})}),(0,v.jsxs)("div",{className:"flex w-[40%] items-center space-x-2",children:[(0,v.jsx)("p",{className:"text-sm",children:Ae().unix(x).utc().format("MMM D, YYYY")}),(0,v.jsx)("p",{className:"text-sm",children:"-"}),(0,v.jsx)("p",{className:"text-sm",children:Ae().unix(f).utc().format("MMM D, YYYY")})]}),(0,v.jsx)("div",{className:"flex w-[15%] items-center justify-end",children:(0,v.jsx)(Pe.default,{href:"/project/".concat(s.ref,"/settings/billing/subscription"),children:(0,v.jsxs)("a",{className:"flex items-center space-x-2 group",children:[(0,v.jsx)("p",{className:"text-xs transition opacity-0 group-hover:opacity-100",children:"View details"}),(0,v.jsx)(l.VG8,{strokeWidth:1.5})]})})})]})]})},ze=function(e){var n=e.projects;return(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("h4",{children:"Projects at a glance"}),(0,v.jsxs)(h.Z,{title:(0,v.jsxs)("div",{className:"flex items-center w-full",children:[(0,v.jsx)("div",{className:"w-[25%]",children:(0,v.jsx)("p",{className:"text-sm opacity-50",children:"Name"})}),(0,v.jsx)("div",{className:"w-[20%]",children:(0,v.jsx)("p",{className:"text-sm opacity-50",children:"Plan"})}),(0,v.jsx)("div",{className:"w-[40%]",children:(0,v.jsx)("p",{className:"text-sm opacity-50",children:"Billing cycle"})}),(0,v.jsx)("div",{className:"w-[15%]"})]}),children:[n.map((function(e){return(0,v.jsx)(Ee,{project:e},e.ref)})),0===n.length&&(0,v.jsx)(h.Z.Content,{children:(0,v.jsx)("p",{className:"text-sm text-scale-1100",children:"No projects created yet"})})]})]})},De=function(e){var n=e.balance,r=e.isCredit,t=e.isDebt;return(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{className:"space-y-1",children:[(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)("h4",{children:"Credit balance"}),r&&(0,v.jsx)(l.Cts,{children:"You have credits available"}),t&&(0,v.jsx)(l.Cts,{color:"red",children:"Outstanding payments"})]}),(0,v.jsx)("p",{className:"text-sm opacity-50",children:"Charges will be deducted from your balance first"})]}),(0,v.jsxs)("div",{className:"flex items-end space-x-1",children:[t&&(0,v.jsx)("h4",{className:"opacity-50",children:"-"}),(0,v.jsx)("h4",{className:"opacity-50",children:"$"}),(0,v.jsx)("h2",{className:"text-4xl",children:n}),r&&(0,v.jsx)("h4",{className:"opacity-50",children:"/credits"})]})]})},Ze=r(98574),Re=r(37533),Me=r(38230),Fe=function(e){var n,r,t,i,c=e.loading,x=e.defaultPaymentMethod,f=e.paymentMethods,y=e.onDefaultMethodUpdated,g=e.onPaymentMethodsDeleted,b=(0,u.oR)().ui,j=null!==(n=null===(r=b.selectedOrganization)||void 0===r?void 0:r.slug)&&void 0!==n?n:"",w=(0,o.useState)(),N=w[0],O=w[1],C=(0,o.useState)(),S=C[0],k=C[1],P=(0,o.useState)(!1),T=P[0],A=P[1],I=(0,o.useState)(!1),E=I[0],z=I[1],D=(0,u.FH)(d.KA.BILLING_READ,"stripe.payment_methods"),Z=(0,u.FH)(d.KA.BILLING_WRITE,"stripe.payment_methods"),R=function(){var e=(0,a.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,z(!0),e.next=4,(0,p.r$)("".concat(m.T5,"/organizations/").concat(j,"/customer"),{invoice_settings:{default_payment_method:N.id}});case 4:if(!(n=e.sent).error){e.next=7;break}throw n.error;case 7:y(n),O(void 0),b.setNotification({category:"success",message:"Successfully updated default payment method"}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),b.setNotification({category:"error",message:"Failed to make payment method default: ".concat(e.t0.message)});case 15:return e.prev=15,z(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,a.Z)(s().mark((function e(){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,z(!0),e.next=4,(0,p.$v)("".concat(m.T5,"/organizations/").concat(j,"/payments"),{card_id:S.id});case 4:if(n=e.sent,!(r=n.error)){e.next=8;break}throw r;case 8:g(),k(void 0),b.setNotification({category:"success",message:"Successfully deleted payment method"}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),b.setNotification({category:"error",message:"Failed to delete payment method: ".concat(e.t0.message)});case 16:return e.prev=16,z(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})));return function(){return e.apply(this,arguments)}}();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{children:"Payment methods"}),(0,v.jsx)("p",{className:"text-sm opacity-50",children:'When adding a new payment method, either remove the old one or go to your projects\' subscription to explicitly update the payment method. Marking a payment method as "default" is only relevant for new projects or if there are no other payment methods on your account.'})]}),D?(0,v.jsx)(h.Z,{loading:c,footer:!c&&(0,v.jsxs)("div",{className:"flex w-full justify-between",children:[Z?(0,v.jsx)("div",{}):(0,v.jsx)("p",{className:"text-sm text-scale-1000",children:"You need additional permissions to manage this organization's payment methods"}),(0,v.jsx)("div",{children:(0,v.jsx)(l.zxk,{type:"default",icon:(0,v.jsx)(l.SC9,{}),disabled:!Z,onClick:function(){return A(!0)},children:"Add new card"},"panel-footer")})]}),children:c&&0===f.length?(0,v.jsxs)("div",{className:"flex flex-col justify-between space-y-2 py-4 px-4",children:[(0,v.jsx)("div",{className:"shimmering-loader mx-1 w-2/3 rounded py-3"}),(0,v.jsx)("div",{className:"shimmering-loader mx-1 w-1/2 rounded py-3"}),(0,v.jsx)("div",{className:"shimmering-loader mx-1 w-1/3 rounded py-3"})]}):f.length>=1?(0,v.jsx)(h.Z.Content,{children:(0,v.jsx)("div",{className:"space-y-2",children:f.map((function(e){var n=e.id===x;return(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,v.jsx)("img",{src:"/img/payment-methods/".concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,v.jsx)(l.IIB,{readOnly:!0,className:"w-64",size:"small",value:"\u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 ".concat(e.card.last4)}),n?(0,v.jsx)(l.Cts,{color:"gray",children:"Default"}):(0,v.jsx)("div",{className:"opacity-0",children:(0,v.jsx)(l.Cts,{color:"gray",children:"Default"})}),(0,v.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",e.card.exp_month,"/",e.card.exp_year]})]}),Z&&(0,v.jsx)(v.Fragment,{children:n?(0,v.jsxs)(_.fC,{delayDuration:0,children:[(0,v.jsx)(_.xz,{children:(0,v.jsx)(l.zxk,{disabled:!0,as:"span",type:"outline",icon:(0,v.jsx)(l.kLi,{})})}),(0,v.jsxs)(_.VY,{side:"bottom",children:[(0,v.jsx)(_.Eh,{className:"radix-tooltip-arrow"}),(0,v.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","w-48 border border-scale-200 text-center"].join(" "),children:(0,v.jsx)("span",{className:"text-xs text-scale-1200",children:"Your default payment method cannot be deleted"})})]})]}):(0,v.jsx)(l.Ltx,{size:"tiny",overlay:[(0,v.jsx)(l.Ltx.Item,{onClick:function(){return O(e)},children:"Make default"},"make-default"),(0,v.jsx)(l.Ltx.Item,{onClick:function(){return k(e)},children:"Delete"},"delete-method")],children:(0,v.jsx)(l.zxk,{type:"outline",icon:(0,v.jsx)(l.q3n,{}),loading:c,className:"hover:border-gray-500"})})})]},e.id)}))})}):(0,v.jsx)(h.Z.Content,{children:(0,v.jsxs)("div",{className:"flex items-center space-x-2 opacity-50",children:[(0,v.jsx)(l.bln,{}),(0,v.jsx)("p",{className:"text-sm",children:"No payment methods"})]})})}):(0,v.jsx)(h.Z,{children:(0,v.jsx)(Me.Z,{resourceText:"view this organization's payment methods"})})]}),(0,v.jsx)(Re.AddNewPaymentMethodModal,{visible:T,returnUrl:"".concat((0,Ze.Ax)(),"/org/").concat(j,"/billing"),onCancel:function(){return A(!1)}}),(0,v.jsx)(l.u_l,{visible:void 0!==N,size:"small",header:"Set payment method as default",onCancel:function(){return O(void 0)},customFooter:(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[(0,v.jsx)(l.zxk,{type:"default",onClick:function(){return O(void 0)},children:"Cancel"}),(0,v.jsx)(l.zxk,{type:"primary",loading:E,onClick:R,children:"Confirm"})]}),children:(0,v.jsx)("div",{className:"py-4",children:(0,v.jsx)(l.u_l.Content,{children:(0,v.jsxs)("p",{className:"text-sm",children:["Confirm to set selected payment method (Ending with"," ",null!==(t=null===N||void 0===N||null===(i=N.card)||void 0===i?void 0:i.last4)&&void 0!==t?t:"",") as the default?"]})})})}),(0,v.jsx)(l.u_l,{visible:void 0!==S,size:"medium",header:"Delete payment method",onCancel:function(){return k(void 0)},customFooter:(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[(0,v.jsx)(l.zxk,{type:"default",onClick:function(){return k(void 0)},children:"Cancel"}),(0,v.jsx)(l.zxk,{type:"primary",loading:E,onClick:M,children:"Confirm"})]}),children:(0,v.jsx)("div",{className:"py-4",children:(0,v.jsx)(l.u_l.Content,{children:(0,v.jsx)(l.bZj,{withIcon:!0,variant:"warning",title:"This will permanently delete your payment method.",children:(0,v.jsx)("p",{className:"",children:"Any subscription currently charging this payment method will start charging your default payment method."})})})})})]})},Be=[{code:"AF",name:"Afghanistan"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"VG",name:"British Virgin Islands"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CV",name:"Cape Verde"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Cura\xe7ao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"CI",name:"C\xf4te d'Ivoire"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard & McDonald Islands"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"KP",name:"North Korea"},{code:"MK",name:"North Macedonia"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territories"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn Islands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"RE",name:"R\xe9union"},{code:"BL",name:"Saint Barth\xe9lemy"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"KR",name:"South Korea"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SH",name:"St Helena"},{code:"KN",name:"St Kitts and Nevis"},{code:"LC",name:"St Lucia"},{code:"MF",name:"St Martin"},{code:"PM",name:"St Pierre and Miquelon"},{code:"VC",name:"St Vincent and the Grenadines"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard & Jan Mayen"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad & Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks & Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"VI",name:"US Virgin Islands"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States of America"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"WF",name:"Wallis & Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"},{code:"AX",name:"\xc5land Islands"}],Le=function(e){var n,r,t=e.loading,i=e.address,c=e.onAddressUpdated,x=(0,u.oR)().ui,f=null!==(n=null===(r=x.selectedOrganization)||void 0===r?void 0:r.slug)&&void 0!==n?n:"",y=i.city,g=i.country,b=i.line1,j=i.line2,w=i.postal_code,N=i.state,_=(0,u.FH)(d.KA.BILLING_READ,"stripe.customer"),C=(0,u.FH)(d.KA.BILLING_WRITE,"stripe.customer"),S=(0,o.useState)(!1),k=S[0],P=S[1],T={city:y,country:g,line1:b,line2:j,postal_code:w,state:N},A=function(){var e=(0,a.Z)(s().mark((function e(n,r){var t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.setSubmitting,e.prev=1,t(!0),e.next=5,(0,p.r$)("".concat(m.T5,"/organizations/").concat(f,"/customer"),{address:n});case 5:if(!(a=e.sent).error){e.next=8;break}throw a.error;case 8:x.setNotification({category:"success",message:"Successfully updated billing address"}),c(a.address),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),x.setNotification({category:"error",message:"Failed to update billing address: ".concat(e.t0.message)});case 15:return e.prev=15,t(!1),P(!1),e.finish(15);case 19:case"end":return e.stop()}}),e,null,[[1,12,15,19]])})));return function(n,r){return e.apply(this,arguments)}}();return(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{children:"Billing address"}),(0,v.jsx)("p",{className:"text-sm opacity-50",children:"This will be reflected in every invoice"})]}),(0,v.jsx)(h.Z,{loading:t,children:t?(0,v.jsxs)("div",{className:"flex flex-col justify-between space-y-2 py-4 px-4",children:[(0,v.jsx)("div",{className:"shimmering-loader mx-1 w-2/3 rounded py-3"}),(0,v.jsx)("div",{className:"shimmering-loader mx-1 w-1/2 rounded py-3"}),(0,v.jsx)("div",{className:"shimmering-loader mx-1 w-1/3 rounded py-3"})]}):_?(0,v.jsx)(l.l09,{validateOnBlur:!0,initialValues:T,validate:function(e){return(0,O.isEqual)(e,T)?P(!1):P(!0),{}},onSubmit:A,children:function(e){var n=e.isSubmitting,r=e.handleReset;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(h.Z.Content,{className:"w-3/5 space-y-2",children:[(0,v.jsx)(l.IIB,{id:"line1",name:"line1",placeholder:"Address line 1",disabled:!C}),(0,v.jsx)(l.IIB,{id:"line2",name:"line2",placeholder:"Address line 2",disabled:!C}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsxs)(l.RiT,{className:"w-full",id:"country",name:"country",placeholder:"Country",disabled:!C,children:[(0,v.jsx)(l.RiT.Option,{label:"---",value:"",children:"---"},"empty"),Be.map((function(e){return(0,v.jsx)(l.RiT.Option,{label:e.name,value:e.code,children:e.name},e.code)}))]}),(0,v.jsx)(l.IIB,{className:"w-full",id:"postal_code",name:"postal_code",placeholder:"Postal code",disabled:!C})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(l.IIB,{className:"w-full",id:"city",name:"city",placeholder:"City",disabled:!C}),(0,v.jsx)(l.IIB,{className:"w-full",id:"state",name:"state",placeholder:"State",disabled:!C})]})]}),(0,v.jsx)("div",{className:"border-t border-scale-400"}),(0,v.jsxs)(h.Z.Content,{className:"flex justify-between",children:[C?(0,v.jsx)("div",{}):(0,v.jsx)("p",{className:"text-sm text-scale-1000",children:"You need additional permissions to update this organization's billing address"}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(l.zxk,{type:"default",htmlType:"reset",disabled:!k||n||!C,onClick:function(){r(),P(!1)},children:"Cancel"}),(0,v.jsx)(l.zxk,{type:"primary",htmlType:"submit",loading:n,disabled:!k||n||!C,children:"Save"})]})]})]})}}):(0,v.jsx)(Me.Z,{resourceText:"view this organization's billing address"})})]})},Ve=[{name:"AE TRN",code:"ae_trn",country:"United Arab Emirates",placeholder:"123456789012345"},{name:"AT VAT",code:"eu_vat",country:"Austria",placeholder:"ATU12345678"},{name:"AU ABN",code:"au_abn",country:"Australia",placeholder:"12345678912"},{name:"AU ARN",code:"au_arn",country:"Australia",placeholder:"123456789123"},{name:"BE VAT",code:"eu_vat",country:"Belgium",placeholder:"BE0123456789"},{name:"BG VAT",code:"eu_vat",country:"Bulgaria",placeholder:"BG0123456789"},{name:"BR CNPJ",code:"br_cnpj",country:"Brazil",placeholder:"01.234.456/5432-10"},{name:"BR CPF",code:"br_cpf",country:"Brazil",placeholder:"123.456.789-87"},{name:"CA BN",code:"ca_bn",country:"Canada",placeholder:"123456789"},{name:"CA GST/HST",code:"ca_gst_hst",country:"Canada",placeholder:"123456789RT0002"},{name:"CA PST-BC",code:"ca_pst_bc",country:"Canada",placeholder:"PST-1234-5678"},{name:"CA PST-MB",code:"ca_pst_mb",country:"Canada",placeholder:"123456-7"},{name:"CA PST-SK",code:"ca_pst_mb",country:"Canada",placeholder:"1234567"},{name:"CA QST",code:"ca_qst",country:"Canada",placeholder:"1234567890TQ1234"},{name:"CH VAT",code:"ch_vat",country:"Switzerland",placeholder:"CHE-123.456.789 MWST"},{name:"CL TIN",code:"cl_tin",country:"Chile",placeholder:"12.345.678-K"},{name:"CY VAT",code:"eu_vat",country:"Cyprus",placeholder:"CY12345678Z"},{name:"CZ VAT",code:"eu_vat",country:"Czech Republic",placeholder:"CZ1234567890"},{name:"DE VAT",code:"eu_vat",country:"Germany",placeholder:"DE123456789"},{name:"DK VAT",code:"eu_vat",country:"Denmark",placeholder:"DK12345678"},{name:"EE VAT",code:"eu_vat",country:"Estonia",placeholder:"EE123456789"},{name:"ES CIF",code:"es_cif",country:"Spain",placeholder:"A12345678"},{name:"ES VAT",code:"eu_vat",country:"Spain",placeholder:"ESA1234567Z"},{name:"FI VAT",code:"eu_vat",country:"Finland",placeholder:"FI12345678"},{name:"FR VAT",code:"eu_vat",country:"France",placeholder:"FRAB123456789"},{name:"GB VAT",code:"eu_vat",country:"United Kingdom",placeholder:"GB123456789"},{name:"GE VAT",code:"ge_vat",country:"Georgia",placeholder:"123456789"},{name:"EL VAT",code:"eu_vat",country:"Greece",placeholder:"EL123456789"},{name:"HK BR",code:"hk_br",country:"Hong Kong SAR China",placeholder:"12345678"},{name:"HR VAT",code:"eu_vat",country:"Croatia",placeholder:"HR12345678912"},{name:"HU VAT",code:"eu_vat",country:"Hungary",placeholder:"HU12345678912"},{name:"ID NPWP",code:"id_npwp",country:"Indonesia",placeholder:"12.345.678.9-012.345"},{name:"IE VAT",code:"eu_vat",country:"Ireland",placeholder:"IE1234567AB"},{name:"IL VAT",code:"il_vat",country:"Israel",placeholder:"000012345"},{name:"IN GST",code:"in_gst",country:"India",placeholder:"12ABCDE3456FGZH"},{name:"IS VAT",code:"is_vat",country:"Iceland",placeholder:"123456"},{name:"IT VAT",code:"eu_vat",country:"Italy",placeholder:"IT12345678912"},{name:"JP CN",code:"jp_cn",country:"Japan",placeholder:"1234567891234"},{name:"JP RN",code:"jp_rn",country:"Japan",placeholder:"12345"},{name:"KR BRN",code:"kr_brn",country:"Korea",placeholder:"123-45-67890"},{name:"LI UID",code:"li_uid",country:"Liechtenstein",placeholder:"CHE123456789"},{name:"LT VAT",code:"eu_vat",country:"Lithuania",placeholder:"LT123456789123"},{name:"LU VAT",code:"eu_vat",country:"Luxembourg",placeholder:"LU12345678"},{name:"LV VAT",code:"eu_vat",country:"Latvia",placeholder:"LV12345678912"},{name:"MT VAT",code:"eu_vat",country:"Malta",placeholder:"MT12345678"},{name:"MX RFC",code:"mx_rfc",country:"Mexico",placeholder:"ABC010203AB9"},{name:"MY FRP",code:"my_frp",country:"Malaysia",placeholder:"12345678"},{name:"MY ITN",code:"my_itn",country:"Malaysia",placeholder:"C 1234567890"},{name:"MY SST",code:"my_sst",country:"Malaysia",placeholder:"A12-3456-78912345"},{name:"NL VAT",code:"eu_vat",country:"Netherlands",placeholder:"NL123456789B12"},{name:"NO VAT",code:"no_vat",country:"Norway",placeholder:"123456789MVA"},{name:"NZ GST",code:"nz_gst",country:"New Zealand",placeholder:"123456789"},{name:"PL VAT",code:"eu_vat",country:"Poland",placeholder:"PL1234567890"},{name:"PT VAT",code:"eu_vat",country:"Portugal",placeholder:"PT123456789"},{name:"RO VAT",code:"eu_vat",country:"Romania",placeholder:"RO1234567891"},{name:"RU INN",code:"ru_inn",country:"Russia",placeholder:"1234567891"},{name:"RU KPP",code:"ru_kpp",country:"Russia",placeholder:"123456789"},{name:"SA VAT",code:"sa_vat",country:"Saudi Arabia",placeholder:"123456789012345"},{name:"SE VAT",code:"eu_vat",country:"Sweden",placeholder:"SE123456789123"},{name:"SG GST",code:"sg_gst",country:"Singapore",placeholder:"M12345678X"},{name:"SG UEN",code:"sg_uen",country:"Singapore",placeholder:"123456789F"},{name:"SI VAT",code:"eu_vat",country:"Slovenia",placeholder:"SI12345678"},{name:"SK VAT",code:"eu_vat",country:"Slovakia",placeholder:"SK1234567891"},{name:"TH VAT",code:"th_vat",country:"Thailand",placeholder:"1234567891234"},{name:"TW VAT",code:"tw_vat",country:"Taiwan",placeholder:"12345678"},{name:"UA VAT",code:"ua_vat",country:"Ukraine",placeholder:"123456789"},{name:"US EIN",code:"us_ein",country:"United States",placeholder:"12-3456789"},{name:"XI VAT",code:"eu_vat",country:"United Kingdom (Northern Ireland)",placeholder:"XI123456789"},{name:"ZA VAT",code:"za_vat",country:"South Africa",placeholder:"4123456789"}],Ge=function(e){var n,r=e,t=Ve.find((function(n){return n.name===e.name})),a=null===t||void 0===t||null===(n=t.placeholder.match(/[a-z]+|[^a-z]+/gi))||void 0===n?void 0:n[0];return"eu_vat"===e.type&&a&&!e.value.startsWith(a)&&(r.value="".concat(a).concat(e.value)),r};function Ue(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function Ke(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Ue(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ue(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var He=function(e){var n,r,i=e.loading,c=e.taxIds,x=e.onTaxIdsUpdated,f=(0,u.oR)().ui,y=null!==(n=null===(r=f.selectedOrganization)||void 0===r?void 0:r.slug)&&void 0!==n?n:"",g=(0,o.useState)(!1),b=g[0],j=g[1],w=(0,o.useState)([]),N=w[0],_=w[1],C=(0,o.useState)(c),S=C[0],k=C[1],P=c.map((function(e){var n,r;return{id:e.id,type:e.type,value:e.value,name:"eu_vat"===e.type?"".concat(e.country," VAT"):null!==(n=null===(r=Ve.find((function(n){return n.code===e.type})))||void 0===r?void 0:r.name)&&void 0!==n?n:""}}));(0,o.useEffect)((function(){if(0===S.length)k(P);else{var e=S.filter((function(e){return N.includes(e.id)}));k(P.concat(e))}}),[c]);var T=!(0,O.isEqual)(S,P),A=(0,u.FH)(d.KA.BILLING_READ,"stripe.tax_ids"),I=(0,u.FH)(d.KA.BILLING_WRITE,"stripe.tax_ids"),E=function(e,n,r){var a=S.map((function(a){if(a.id===e){if("name"===n){var i,s=Ve.find((function(e){return e.name===r}));return Ke(Ke({},a),{},(i={},(0,t.Z)(i,n,r),(0,t.Z)(i,"type",null===s||void 0===s?void 0:s.code),i))}return Ke(Ke({},a),{},(0,t.Z)({},n,r))}return a}));k(a)},z=function(){var e=(0,a.Z)(s().mark((function e(){var n,r,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,Promise.all(c.map(function(){var e=(0,a.Z)(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.$v)("".concat(m.T5,"/organizations/").concat(y,"/tax-ids"),{id:n.id});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 4:return e.sent,e.next=7,Promise.all(S.map(function(){var e=(0,a.Z)(s().mark((function e(n){var r,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ge(n),e.next=3,(0,p.v_)("".concat(m.T5,"/organizations/").concat(y,"/tax-ids"),{type:r.type,value:r.value});case 3:return t=e.sent,e.abrupt("return",{id:r.id,result:t});case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 7:n=e.sent,r=n.filter((function(e){if(e.result.error)return e})),_(r.map((function(e){return e.id}))),r.length>0?r.forEach((function(e){f.setNotification({category:"error",message:e.result.error.message})})):f.setNotification({category:"success",message:"Successfully updated tax IDs"}),t=n.filter((function(e){return!e.result.error})).map((function(e){return e.result})),x(t),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),f.setNotification({category:"error",message:"Failed to save tax IDs"});case 18:return e.prev=18,j(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[1,15,18,21]])})));return function(){return e.apply(this,arguments)}}();return(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{children:"Tax ID"}),(0,v.jsxs)("p",{className:"text-sm opacity-50",children:["If you would like to include specific tax ID(s) to your invoices. ",(0,v.jsx)("br",{}),"Make sure the tax ID looks exactly like the placeholder text."]})]}),A?(0,v.jsx)(h.Z,{loading:i,footer:!i&&(0,v.jsxs)("div",{className:"flex w-full justify-between",children:[I?(0,v.jsx)("div",{}):(0,v.jsx)("p",{className:"text-sm text-scale-1000",children:"You need additional permissions to update this organization's tax IDs"}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(l.zxk,{type:"default",htmlType:"reset",disabled:!T||b,onClick:function(){k(P)},children:"Cancel"}),(0,v.jsx)(l.zxk,{type:"primary",htmlType:"submit",loading:b,disabled:!T||b,onClick:function(){return z()},children:"Save"})]})]}),children:i&&0===S.length?(0,v.jsxs)("div",{className:"flex flex-col justify-between space-y-2 py-4 px-4",children:[(0,v.jsx)("div",{className:"shimmering-loader mx-1 w-2/3 rounded py-3"}),(0,v.jsx)("div",{className:"shimmering-loader mx-1 w-1/2 rounded py-3"}),(0,v.jsx)("div",{className:"shimmering-loader mx-1 w-1/3 rounded py-3"})]}):(0,v.jsxs)(h.Z.Content,{className:"w-8/12 space-y-4",children:[S.length>=1?(0,v.jsx)("div",{className:"w-full space-y-2",children:S.map((function(e,n){var r,t=Ve.find((function(n){return n.name===e.name}));return(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(l.PhF,{value:null===t||void 0===t?void 0:t.name,onChange:function(n){return E(e.id,"name",n.target.value)},disabled:!I,children:Ve.sort((function(e,n){return e.country.localeCompare(n.country)})).map((function(e){return(0,v.jsxs)(l.PhF.Option,{value:e.name,children:[e.country," - ",e.name]},e.name)}))}),(0,v.jsx)(l.IIB,{value:e.value,placeholder:null!==(r=null===t||void 0===t?void 0:t.placeholder)&&void 0!==r?r:"",onChange:function(n){return E(e.id,"value",n.target.value)},disabled:!I}),I&&(0,v.jsx)(l.zxk,{type:"text",icon:(0,v.jsx)(l.kLi,{}),onClick:function(){return function(e){var n=S.filter((function(n){return n.id!==e}));k(n)}(e.id)}})]},"tax-id-".concat(n))}))}):(0,v.jsx)("div",{children:(0,v.jsx)("p",{className:"flex items-center space-x-2 text-sm text-scale-900",children:"No tax IDs"})}),I&&(0,v.jsxs)("div",{className:"flex cursor-pointer items-center space-x-2 opacity-50 transition hover:opacity-100",onClick:function(){return function(){var e={id:(0,Ze.k$)(),type:Ve[0].code,value:"",name:Ve[0].name},n=S.concat([e]);k(n)}()},children:[(0,v.jsx)(l.SC9,{size:14}),(0,v.jsx)("p",{className:"text-sm",children:"Add another ID"})]})]})}):(0,v.jsx)(h.Z,{children:(0,v.jsx)(Me.Z,{resourceText:"to view this organization's tax IDs"})})]})};function Ye(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function We(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Ye(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var qe=function(){var e,n=(0,u.oR)(),r=n.app,t=n.ui,i=(0,u.UO)().slug,c=null!==(e=t.selectedOrganization)&&void 0!==e?e:{},h=c.name,x=c.billing_email,f="org-billing-email",y={billing_email:null!==x&&void 0!==x?x:""},g=(0,u.FH)(d.KA.UPDATE,"organizations"),j=(0,u.FH)(d.KA.READ,"organizations"),w=function(){var e=(0,a.Z)(s().mark((function e(n,a){var o,c,l,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.setSubmitting,c=a.resetForm,g){e.next=3;break}return e.abrupt("return",t.setNotification({category:"error",message:"You do not have the required permissions to update this organization"}));case 3:return o(!0),e.next=6,(0,p.r$)("".concat(m.T5,"/organizations/").concat(i),We(We({},n),{},{name:h}));case 6:(l=e.sent).error?t.setNotification({category:"error",message:"Failed to update organization: ".concat(l.error.message)}):(d=l.billing_email,c({values:{billing_email:d},initialValues:{billing_email:d}}),r.onOrgUpdated(l),t.setNotification({category:"success",message:"Successfully saved settings"})),o(!1);case 9:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}();return(0,v.jsxs)("div",{className:"container my-4 max-w-4xl",children:[(0,v.jsx)("h4",{children:"Billing email"}),(0,v.jsx)("p",{className:"text-sm opacity-50",children:"All billing correspondence will go to this email"}),(0,v.jsx)("div",{className:"mt-3",children:(0,v.jsx)(l.l09,{id:f,initialValues:y,onSubmit:w,children:function(e){var n=e.isSubmitting,r=e.handleReset,t=e.values,a=e.initialValues,s=e.resetForm,c=JSON.stringify(t)!==JSON.stringify(a);return(0,o.useEffect)((function(){var e={billing_email:null!==x&&void 0!==x?x:""};s({values:e,initialValues:e})}),[i]),(0,v.jsx)(b.by,{footer:(0,v.jsx)("div",{className:"flex py-4 px-8",children:(0,v.jsx)(b.iN,{form:f,isSubmitting:n,hasChanges:c,handleReset:r,helper:g?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,v.jsx)(b.hj,{className:"-mx-2",children:(0,v.jsx)(b.B4,{loading:!1,children:(0,v.jsx)(l.IIB,{id:"billing_email",size:"small",label:"Email address",type:j?"text":"password",disabled:!g})})})})}})})]})};function Je(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function Qe(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Je(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Je(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var $e=(0,c.Pi)((function(){var e,n,r,t=(0,u.oR)(),i=t.app,c=t.ui,l=(0,u.UO)().slug,d=c.selectedOrganization,h=i.projects.list((function(e){return e.organization_id==(null===d||void 0===d?void 0:d.id)}))||[],x=(0,o.useState)(null),f=x[0],y=x[1],g=(0,o.useState)(!1),b=g[0],j=g[1],w=(0,o.useState)(null),N=w[0],_=w[1],O=(0,o.useState)(!1),C=O[0],S=O[1],k=(0,o.useState)(null),P=k[0],T=k[1],A=(0,o.useState)(!1),I=A[0],E=A[1],z=null!==(e=null===f||void 0===f||null===(n=f.invoice_settings)||void 0===n?void 0:n.default_payment_method)&&void 0!==e?e:"",D=f&&f.balance?f.balance/100:0,Z=D<0,R=D>0,M=Z&&0!==D?D.toString().replace("-",""):D;(0,o.useEffect)((function(){F(),B(),L()}),[l]);var F=function(){var e=(0,a.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(!0),e.next=4,(0,p.U2)("".concat(m.T5,"/organizations/").concat(l,"/customer"));case 4:if(!(n=e.sent).error){e.next=7;break}throw n.error;case 7:y(n),j(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),c.setNotification({error:e.t0,category:"error",message:"Failed to get organization information: ".concat(e.t0.message)});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,a.Z)(s().mark((function e(){var n,r,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,S(!0),e.next=4,(0,p.U2)("".concat(m.T5,"/organizations/").concat(l,"/payments"));case 4:if(n=e.sent,r=n.data,!(t=n.error)){e.next=9;break}throw t;case 9:_(r),S(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),c.setNotification({error:e.t0,category:"error",message:"Failed to get organization payment methods: ".concat(e.t0.message)});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,a.Z)(s().mark((function e(){var n,r,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,E(!0),e.next=4,(0,p.U2)("".concat(m.T5,"/organizations/").concat(l,"/tax-ids"));case 4:if(n=e.sent,r=n.data,!(t=n.error)){e.next=9;break}throw t;case 9:T(r),E(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),c.setNotification({error:e.t0,category:"error",message:"Failed to get organization tax IDs: ".concat(e.t0.message)});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return(0,v.jsx)("article",{className:"container my-4 max-w-4xl space-y-8",children:(0,v.jsxs)("div",{className:"space-y-8",children:[(0,v.jsx)(ze,{projects:h}),(0,v.jsx)(De,{balance:M,isCredit:Z,isDebt:R}),(0,v.jsx)(Fe,{loading:b||C,defaultPaymentMethod:z,paymentMethods:N||[],onDefaultMethodUpdated:y,onPaymentMethodsDeleted:function(){return B()}}),(0,v.jsx)(qe,{}),(0,v.jsx)(Le,{loading:b,address:null!==(r=null===f||void 0===f?void 0:f.address)&&void 0!==r?r:{},onAddressUpdated:function(e){return y(Qe(Qe({},f),{},{address:e}))}}),(0,v.jsx)(He,{loading:I,taxIds:P||[],onTaxIdsUpdated:function(e){return T(e)}})]})})})),Xe=function(){var e,n=(0,u.oR)().ui,r=(0,o.useState)(!1),t=r[0],i=r[1],c=(0,o.useState)(1),h=c[0],x=c[1],f=(0,o.useState)(0),y=f[0],g=f[1],b=(0,o.useState)([]),j=b[0],w=b[1],N=(null!==(e=n.selectedOrganization)&&void 0!==e?e:{}).stripe_customer_id,_=10*(h-1),O=(0,u.FH)(d.KA.READ,"invoices");(0,o.useEffect)((function(){if(O){var e=!1,r=function(){var r=(0,a.Z)(s().mark((function r(){var t;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,p.YM)("".concat(m.T5,"/stripe/invoices?customer=").concat(N),["X-Total-Count"]);case 2:t=r.sent,e||(t.error?n.setNotification({category:"error",message:t.error.message}):g(t["X-Total-Count"]));case 4:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return x(1),C(1),r(),function(){e=!0}}}),[N]);var C=function(){var e=(0,a.Z)(s().mark((function e(r){var t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),x(r),t=10*(r-1),e.next=5,(0,p.U2)("".concat(m.T5,"/stripe/invoices?offset=").concat(t,"&limit=").concat(10,"&customer=").concat(N));case 5:(a=e.sent).error?n.setNotification({category:"error",message:a.error.message}):w(a),i(!1);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),S=function(){var e=(0,a.Z)(s().mark((function e(r){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.U2)("".concat(m.T5,"/stripe/invoices/").concat(r));case 2:null!==(t=e.sent)&&void 0!==t&&t.invoice_pdf?window.open(t.invoice_pdf,"_blank"):n.setNotification({category:"info",message:"Unable to fetch the selected invoice"});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return O?(0,v.jsx)("div",{className:"container my-4 max-w-4xl space-y-1",children:(0,v.jsx)(l.gbz,{active:t,children:(0,v.jsx)(K.Z,{head:[(0,v.jsx)(K.Z.th,{},"header-icon"),(0,v.jsx)(K.Z.th,{children:"Date"},"header-date"),(0,v.jsx)(K.Z.th,{children:"Amount due"},"header-amount"),(0,v.jsx)(K.Z.th,{children:"Invoice number"},"header-invoice"),(0,v.jsx)(K.Z.th,{className:"text-right"},"header-download")],body:0===j.length?(0,v.jsx)(K.Z.tr,{children:(0,v.jsx)(K.Z.td,{colSpan:5,className:"p-3 py-12 text-center",children:(0,v.jsx)("p",{className:"text-scale-1000",children:t?"Checking for invoices":"No invoices for this organization yet"})})}):(0,v.jsxs)(v.Fragment,{children:[j.map((function(e){return(0,v.jsxs)(K.Z.tr,{children:[(0,v.jsx)(K.Z.td,{children:(0,v.jsx)(l.k_6,{size:"xxl"})}),(0,v.jsx)(K.Z.td,{children:(0,v.jsx)("p",{children:new Date(1e3*e.period_end).toLocaleString()})}),(0,v.jsx)(K.Z.td,{children:(0,v.jsxs)("p",{children:["$",e.subtotal/100]})}),(0,v.jsx)(K.Z.td,{children:(0,v.jsx)("p",{children:e.number})}),(0,v.jsx)(K.Z.td,{className:"align-right",children:(0,v.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,v.jsx)(l.zxk,{type:"outline",icon:(0,v.jsx)(l.DjJ,{}),onClick:function(){return S(e.id)}})})})]},e.id)})),(0,v.jsx)(K.Z.tr,{children:(0,v.jsx)(K.Z.td,{colSpan:5,children:(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("p",{className:"text-sm opacity-50",children:["Showing ",_+1," to ",_+j.length," out of ",y," invoices"]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(l.zxk,{icon:(0,v.jsx)(l.ed9,{}),type:"default",size:"tiny",disabled:1===h,onClick:(0,a.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(h-1);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}),(0,v.jsx)(l.zxk,{icon:(0,v.jsx)(l.VG8,{}),type:"default",size:"tiny",disabled:10*h>=y,onClick:(0,a.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(h+1);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))})]})]})})},"navigation")]})})})}):(0,v.jsx)(Me.Z,{resourceText:"view invoices"})}},33003:function(e,n,r){r.d(n,{iN:function(){return h},ph:function(){return s},by:function(){return m},hj:function(){return c},B4:function(){return u},S0:function(){return l},ld:function(){return a}});var t=r(24246);function a(e){return(0,t.jsxs)("div",{className:"mx-auto max-w-4xl px-5 pt-12 pb-20",children:[e.header&&(0,t.jsx)("h1",{className:"text-scale-1200 mb-8 text-3xl",children:e.header}),(0,t.jsx)("div",{className:"space-y-20",children:e.children})]})}var i=r(87190),s=function(e){var n=e.title,r=e.description;return(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-scale-1200 mb-2 text-xl",children:(0,t.jsx)(i.D,{unwrapDisallowed:!0,disallowedElements:["p"],children:n})}),(0,t.jsx)("div",{className:"text-scale-900 text-sm",children:(0,t.jsx)(i.D,{children:r})})]})},o=r(27378),c=function(e){var n=e.children,r=e.header,a=e.disabled,i=e.visible,s=void 0===i||i,o=e.className,c=["grid grid-cols-12 gap-6 px-8 py-8","".concat(a?" opacity-30":" opacity-100"),"".concat(s?" block":" hidden"),"".concat(o)];return(0,t.jsxs)("div",{className:c.join(" "),children:[r,n]})},l=function(e){var n=e.children,r=e.className,a=void 0===r?"":r,i=e.description;return void 0!==i?(0,t.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(a),children:[(0,t.jsx)("label",{className:"text-scale-1200 text-sm",children:n}),i]}):(0,t.jsx)("label",{className:"text-scale-1200 col-span-12 text-sm lg:col-span-5 ".concat(a),children:n})},d=function(){return(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,t.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,t.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,t.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]})},u=function(e){var n=e.children,r=e.loading,a=void 0===r||r,i=e.fullWidth,s=e.className;return(0,t.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(i&&"!col-span-12","\n        ").concat(s,"\n      "),children:a?o.Children.map(n,(function(e){return(0,t.jsx)(d,{})})):n})},m=function(e){var n=e.children,r=e.header,a=e.footer;return(0,t.jsxs)("div",{className:" bg-scale-100 dark:bg-scale-300 border-scale-400 overflow-hidden  rounded-md border shadow",children:[r&&(0,t.jsx)("div",{className:" border-scale-400 border-b px-8 py-4",children:r}),(0,t.jsx)("div",{className:"divide-scale-400 flex flex-col gap-0 divide-y",children:n}),a&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"border-scale-400 border-t"}),a]})]})},p=r(88983),h=function(e){var n=e.form,r=e.hasChanges,a=void 0===r?void 0:r,i=e.handleReset,s=e.helper,o=e.disabled,c=void 0!==o&&o,l=e.isSubmitting,d=e.submitText,u=void 0===d?"Save":d,m=l||c||!a&&void 0!==a;return(0,t.jsxs)("div",{className:["flex w-full items-center gap-2",s?"justify-between":"justify-end"].join(" "),children:[s&&(0,t.jsx)("span",{className:"text-sm text-scale-900",children:s}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.zxk,{disabled:m,type:"default",htmlType:"reset",onClick:function(){return i()},children:"Cancel"}),(0,t.jsx)(p.zxk,{form:n,type:"primary",htmlType:"submit",disabled:m,loading:l,children:u})]})]})}},61276:function(e,n,r){r.d(n,{O:function(){return t}});var t={detail:function(e){return["organizations",e,"detail"]},roles:function(e){return["organizations",e,"roles"]},freeProjectLimitCheck:function(e){return["organizations",e,"free-project-limit-check"]}}},51896:function(e,n,r){r.d(n,{S2:function(){return f}});var t=r(90849),a=r(90089),i=r(55732),s=r(34707),o=r.n(s),c=r(36492),l=r(14919),d=r(20796),u=(r(27378),function(e){return["projects",e,"subscription"]}),m=["enabled"];function p(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function h(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?p(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function x(e,n){return v.apply(this,arguments)}function v(){return(v=(0,i.Z)(o().mark((function e(n,r){var t,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.projectRef){e.next=3;break}throw new Error("projectRef is required");case 3:return e.next=5,(0,l.U2)("".concat(d.T5,"/projects/").concat(t,"/subscription"),{signal:r});case 5:if(!(a=e.sent).error){e.next=8;break}throw a.error;case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var f=function(e){var n=e.projectRef,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,i=void 0===t||t,s=(0,a.Z)(r,m);return(0,c.a)(u(n),(function(e){var r=e.signal;return x({projectRef:n},r)}),h({enabled:i&&"undefined"!==typeof n},s))}},48228:function(e,n,r){r.d(n,{D:function(){return m}});var t=r(27378),a=r(464),i=r(89886),s=r(30081),o=r(33989),c=r(32161);class l extends o.l{constructor(e,n){super(),this.client=e,this.setOptions(n),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.client.defaultMutationOptions(e),(0,c.VS)(n,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this})}onUnsubscribe(){var e;this.listeners.length||(null==(e=this.currentMutation)||e.removeObserver(this))}onMutationUpdate(e){this.updateResult();const n={listeners:!0};"success"===e.type?n.onSuccess=!0:"error"===e.type&&(n.onError=!0),this.notify(n)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(e,n){return this.mutateOptions=n,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:"undefined"!==typeof e?e:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const e=this.currentMutation?this.currentMutation.state:(0,i.R)(),n={...e,isLoading:"loading"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset};this.currentResult=n}notify(e){s.V.batch((()=>{var n,r,t,a;if(this.mutateOptions)if(e.onSuccess)null==(n=(r=this.mutateOptions).onSuccess)||n.call(r,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(t=(a=this.mutateOptions).onSettled)||t.call(a,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context);else if(e.onError){var i,s,o,c;null==(i=(s=this.mutateOptions).onError)||i.call(s,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(o=(c=this.mutateOptions).onSettled)||o.call(c,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}e.listeners&&this.listeners.forEach((e=>{e(this.currentResult)}))}))}}var d=r(85945),u=r(24798);function m(e,n,r){const i=(0,c.lV)(e,n,r),o=(0,d.NL)({context:i.context}),[m]=t.useState((()=>new l(o,i)));t.useEffect((()=>{m.setOptions(i)}),[m,i]);const h=(0,a.$)(t.useCallback((e=>m.subscribe(s.V.batchCalls(e))),[m]),(()=>m.getCurrentResult()),(()=>m.getCurrentResult())),x=t.useCallback(((e,n)=>{m.mutate(e,n).catch(p)}),[m]);if(h.error&&(0,u.L)(m.options.useErrorBoundary,[h.error]))throw h.error;return{...h,mutate:x,mutateAsync:h.mutate}}function p(){}}}]);
//# sourceMappingURL=2769-ab752cede0866f48.js.map